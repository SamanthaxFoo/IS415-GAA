<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Foo Jia Yi Samantha">
<meta name="dcterms.date" content="2024-09-06">

<title>IS415-GAA - Take-home Exercise 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">IS415-GAA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercises">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex1/In-class_Ex1.html">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex2/In-class_Ex2.html">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex3/In-class_Ex3.html">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex4/In-class_Ex4.html">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex5/In-class_Ex5.html">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex6/In-class_Ex6.html">
 <span class="dropdown-text">In-class Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex7/In-class_Ex7.html">
 <span class="dropdown-text">In-class Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex9/In-class_Ex9.html">
 <span class="dropdown-text">In-class Exercise 9</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercises">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex1/Hands-on_Ex1.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex2/Hands-on_Ex2.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex3/Hands-on_Ex3.html">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex5/Hands-on_Ex5.html">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex6/Hands-on_Ex6.html">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex7/Hands-on_Ex7.html">
 <span class="dropdown-text">Hands-on Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex8/Hands-on_Ex8.html">
 <span class="dropdown-text">Hands-on Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex9/Hands-on_Ex9.html">
 <span class="dropdown-text">Hands-on Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex10/Hands-on_Ex10.html">
 <span class="dropdown-text">Hands-on Exercise 10</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex11/Hands-on_Ex11.html">
 <span class="dropdown-text">Hands-on Exercise 11</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercises">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex1/Take-home_Ex1.html">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex2/Take-home_Ex2.html">
 <span class="dropdown-text">Take-home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex3/Take-home_Ex3.html">
 <span class="dropdown-text">Take-home Exercise 3</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><strong>1. Overview</strong></a>
  <ul class="collapse">
  <li><a href="#background-of-myanmars-long-standing-conflicts" id="toc-background-of-myanmars-long-standing-conflicts" class="nav-link" data-scroll-target="#background-of-myanmars-long-standing-conflicts">1.1 Background of Myanmar’s Long-Standing Conflicts</a></li>
  <li><a href="#objectives-of-take-home-exercise-1" id="toc-objectives-of-take-home-exercise-1" class="nav-link" data-scroll-target="#objectives-of-take-home-exercise-1">1.2 Objectives of Take-home Exercise 1</a></li>
  <li><a href="#about-the-datasets" id="toc-about-the-datasets" class="nav-link" data-scroll-target="#about-the-datasets">1.3 About the Datasets</a></li>
  </ul></li>
  <li><a href="#lets-set-up" id="toc-lets-set-up" class="nav-link" data-scroll-target="#lets-set-up"><strong>2. Let’s Set Up!</strong></a>
  <ul class="collapse">
  <li><a href="#importing-libraries-into-r" id="toc-importing-libraries-into-r" class="nav-link" data-scroll-target="#importing-libraries-into-r"><strong>2.1 Importing Libraries into R</strong></a></li>
  <li><a href="#importing-data-sets-into-r" id="toc-importing-data-sets-into-r" class="nav-link" data-scroll-target="#importing-data-sets-into-r"><strong>2.2 Importing Data Sets into R</strong></a></li>
  </ul></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">3. Data Wrangling</a>
  <ul class="collapse">
  <li><a href="#fixing-incorrect-datatypes" id="toc-fixing-incorrect-datatypes" class="nav-link" data-scroll-target="#fixing-incorrect-datatypes">3.1 Fixing Incorrect Datatypes</a></li>
  <li><a href="#adding-new-year_quarter-column" id="toc-adding-new-year_quarter-column" class="nav-link" data-scroll-target="#adding-new-year_quarter-column">3.2 Adding new year_quarter column</a></li>
  <li><a href="#fixing-duplicated-event-id-in-conflict_data-dataframe" id="toc-fixing-duplicated-event-id-in-conflict_data-dataframe" class="nav-link" data-scroll-target="#fixing-duplicated-event-id-in-conflict_data-dataframe">3.3 Fixing Duplicated Event ID in <em>conflict_data</em> Dataframe</a></li>
  <li><a href="#converting-aspatial-data-to-simple-feature-format" id="toc-converting-aspatial-data-to-simple-feature-format" class="nav-link" data-scroll-target="#converting-aspatial-data-to-simple-feature-format">3.4 Converting Aspatial Data to Simple Feature Format</a></li>
  <li><a href="#reduce-data-file-size" id="toc-reduce-data-file-size" class="nav-link" data-scroll-target="#reduce-data-file-size">3.5 Reduce Data File Size</a></li>
  <li><a href="#converting-simple-features-data-frame-into-ppp-object" id="toc-converting-simple-features-data-frame-into-ppp-object" class="nav-link" data-scroll-target="#converting-simple-features-data-frame-into-ppp-object">3.6 Converting Simple Features Data Frame into ppp Object</a></li>
  <li><a href="#creating-owin-object" id="toc-creating-owin-object" class="nav-link" data-scroll-target="#creating-owin-object">3.7 Creating <em>owin</em> object</a></li>
  <li><a href="#combining-ppp-object-and-owin-object" id="toc-combining-ppp-object-and-owin-object" class="nav-link" data-scroll-target="#combining-ppp-object-and-owin-object"><strong>3.8 Combining ppp Object and owin Object</strong></a></li>
  </ul></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis">4. Exploratory Data Analysis</a>
  <ul class="collapse">
  <li><a href="#identifying-districts-with-highest-proportion-of-conflicts" id="toc-identifying-districts-with-highest-proportion-of-conflicts" class="nav-link" data-scroll-target="#identifying-districts-with-highest-proportion-of-conflicts">4.1 Identifying <em>Districts</em> with Highest Proportion of Conflicts</a></li>
  <li><a href="#identifying-states-with-highest-proportion-of-conflicts" id="toc-identifying-states-with-highest-proportion-of-conflicts" class="nav-link" data-scroll-target="#identifying-states-with-highest-proportion-of-conflicts">4.2 Identifying <em>States</em> with Highest Proportion of Conflicts</a></li>
  </ul></li>
  <li><a href="#st-order-spatial-point-patterns-analysis" id="toc-st-order-spatial-point-patterns-analysis" class="nav-link" data-scroll-target="#st-order-spatial-point-patterns-analysis"><strong>5. 1st Order Spatial Point Patterns Analysis</strong></a>
  <ul class="collapse">
  <li><a href="#kernel-density-estimation" id="toc-kernel-density-estimation" class="nav-link" data-scroll-target="#kernel-density-estimation">5.1 Kernel Density Estimation</a></li>
  <li><a href="#nearest-neighbour-analysis" id="toc-nearest-neighbour-analysis" class="nav-link" data-scroll-target="#nearest-neighbour-analysis">5.2 Nearest Neighbour Analysis</a></li>
  <li><a href="#further-data-exploration" id="toc-further-data-exploration" class="nav-link" data-scroll-target="#further-data-exploration">5.3 Further Data Exploration</a></li>
  </ul></li>
  <li><a href="#nd-order-spatial-point-patterns-analysis" id="toc-nd-order-spatial-point-patterns-analysis" class="nav-link" data-scroll-target="#nd-order-spatial-point-patterns-analysis">6. 2nd Order Spatial Point Patterns Analysis</a>
  <ul class="collapse">
  <li><a href="#using-k-function-estimation" id="toc-using-k-function-estimation" class="nav-link" data-scroll-target="#using-k-function-estimation">6.1 Using K-Function Estimation</a></li>
  <li><a href="#using-l-function-estimation" id="toc-using-l-function-estimation" class="nav-link" data-scroll-target="#using-l-function-estimation">6.2 Using L-Function Estimation</a></li>
  </ul></li>
  <li><a href="#spatio-tempmoral-kde" id="toc-spatio-tempmoral-kde" class="nav-link" data-scroll-target="#spatio-tempmoral-kde">7. Spatio-Tempmoral KDE</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-home Exercise 1</h1>
<p class="subtitle lead">Harnessing Geospatial Analytics to Uncover Armed Conflict Patterns in Myanmar</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Foo Jia Yi Samantha </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 6, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">September 6, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview"><strong>1. Overview</strong></h2>
<section id="background-of-myanmars-long-standing-conflicts" class="level3">
<h3 class="anchored" data-anchor-id="background-of-myanmars-long-standing-conflicts">1.1 Background of Myanmar’s Long-Standing Conflicts</h3>
<p><img src="images/GPA Tracker (33).png" class="img-fluid" width="1000"></p>
<p>The conflict in Myanmar is <strong>not just a result of the coup</strong> but is deeply rooted in the country’s decades-old complex ethnic and political landscape, characterised by <strong>tensions between the central government and various ethnic minority groups</strong>, each with its own armed forces. The post-coup violence has exacerbated these <strong>long-standing conflicts,</strong> leading to a severe humanitarian crisis, with thousands killed, hundreds of thousands displaced, and widespread human rights abuses reported.</p>
</section>
<section id="objectives-of-take-home-exercise-1" class="level3">
<h3 class="anchored" data-anchor-id="objectives-of-take-home-exercise-1">1.2 Objectives of Take-home Exercise 1</h3>
<p>As such, Geospatial analytics has become a valuable tool for evaluating and comprehending the intricacies of increasing conflicts. This exercise aims to reveal the spatial and spatio-temporal distribution of armed conflict in Myanmar by leveraging spatial point pattern analysis. Additionally, it aims to gain clearer insights into the geographical and logistical patterns of violence throughout the nation.</p>
<p>By the end of this take-home exercise, I aim to complete these steps in my spatial point pattern analysis in uncovering the distribution of armed conflict in Myanmar.</p>
<ul>
<li>Using appropriate function of <strong>sf</strong> and <strong>tidyverse</strong> packages, import and transform the downloaded armed conflict data and administrative boundary data into sf tibble data.frames.</li>
<li>Using the geospatial data sets prepared, derive <strong>quarterly KDE layers.</strong></li>
<li>Using the geospatial data sets prepared, perform <strong>2nd-Order Spatial Point Patterns Analysis.</strong></li>
<li>Using the geospatial data sets prepared, derive <strong>quarterly spatio-temporal KDE layers.</strong></li>
<li>Using the geospatial data sets prepared, perform <strong>2nd-Order Spatio-temporal Point Patterns Analysis.</strong></li>
<li>Using appropriate <strong>tmap</strong> functions, display the KDE and Spatio-temporal KDE layers on <strong>openstreetmap</strong> of Myanmar.</li>
<li>Describe the <strong>spatial patterns revealed</strong> by the KDE and Spatio-temporal KDE maps.</li>
</ul>
</section>
<section id="about-the-datasets" class="level3">
<h3 class="anchored" data-anchor-id="about-the-datasets">1.3 About the Datasets</h3>
<section id="armed-conflict-data-from-acled" class="level4">
<h4 class="anchored" data-anchor-id="armed-conflict-data-from-acled">1) <strong>Armed Conflict Data (From ACLED)</strong></h4>
<p>This Armed Conflict Location &amp; Event Data (ACLED) is an independent, impartial, international non-profit organisation which owns an extensive database of violent conflict and protest in countries and territories around the world.</p>
<p><img src="images/clipboard-1772056683.png" class="img-fluid"></p>
<p>For the purpose of this exercise, I have downloaded ACLED’s data on Myanmar which includes a series of conflict events, particularly between 1 January 2021 to 30 June 2024.</p>
<p><strong>🔗 Source:</strong> <a href="https://acleddata.com/">ACLED</a></p>
<p><strong>📁 Format:</strong> comma separated values (CSV)</p>
<p>As the dataset is rather extensive, I will be performing my analysis on armed conflict events in a <strong>quarterly basis</strong> to streamline my tasks. The data included in this dataset are as follows:</p>
<p><strong>Event Type</strong></p>
<p>ACLED categorises events into various types. I will mainly be focusing on these four event types: Battles, Explosion/Remote violence, Strategic developments, and Violence against civilians.</p>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td><p><strong>Event Type</strong></p>
<p>ACLED categorises events into various types. I will mainly be focusing on these four event types: Battles, Explosion/Remote violence, Strategic developments, and Violence against civilians.</p>
<ul>
<li><strong>event_id_cnty:</strong> unique ID for each conflict</li>
<li><strong>event_type:</strong> category of event e.g.&nbsp;Battle, Violence Against Civilians, Protests, Explosions/Remote Violence, Strategic Developments</li>
<li><strong>sub_event_type:</strong> a more detailed classification within event type</li>
<li><strong>disorder_type:</strong> classifies the event based on the nature of the disorder e.g.&nbsp;political violence, demonstrations, strategic developments<a href="https://is415-samanthafoo.netlify.app/take-home_ex/take-home_ex1/take-home_ex1#_msocom_1">[A1]</a></li>
<li><strong>civilian_targeting:</strong> yes/no value, whether event involves specifically targeting civilians</li>
<li>Note: when “strategic developments” are used in Event Type, it is also used in the disorder type (vice-versa)</li>
</ul></td>
</tr>
<tr class="even">
<td><p><strong>Location and Geospatial Data</strong></p>
<p>The database provides detailed geographic information, pinpointing the exact or approximate locations of conflict events across Myanmar. This includes cities, towns, and rural areas.</p>
<ul>
<li><strong>iso:</strong> the country code for Myanmar which uses 104 in this case</li>
<li><strong>region:</strong> region of conflict within Myanmar</li>
<li><strong>country:</strong> indicates Myanmar</li>
<li><strong>admin1, admin2, admin3:</strong> 1st, 2nd and 3rd level administration division within Myanmar e.g.&nbsp;states, division, sub-division</li>
<li><strong>location:</strong> specific geographic location or name of the place where the conflict event occurred</li>
<li><strong>latitude:</strong> latitude of the conflict event</li>
<li><strong>longitude:</strong> longitude of the conflict event</li>
<li><strong>geo_precision:</strong> indicates the level of precision for the geographic coordinates provided</li>
</ul></td>
</tr>
<tr class="odd">
<td><p><strong>Date and Time</strong></p>
<p>ACLED records the specific dates and, where possible, times of conflict events.</p>
<ul>
<li><strong>event_date:</strong> date of conflict</li>
<li><strong>year:</strong> year of conflict</li>
<li><strong>time_precision:</strong> accuracy of the date and time information provided</li>
</ul></td>
</tr>
<tr class="even">
<td><p><strong>Actors</strong></p>
<ul>
<li>Indicate the actors involved in the conflict, such as the Tatmadaw (Myanmar’s military), ethnic armed organizations, local militias, civilian protestors, and other groups.</li>
<li><strong>actor1:</strong> primary actor involved in the conflict event. E.g. a government force, rebel group, militia, or any organised entity</li>
<li><strong>assoc_actor_1:</strong> a secondary group that is aligned with or supports the primary actor (Actor1) in the event</li>
<li><strong>inter1:</strong> an interaction code that categorises actor1, could be a government force, rebel group, military force, rioter, civilian, or other entities</li>
<li><strong>interaction:</strong>&nbsp;combined description of actor1 and actor2</li>
</ul></td>
</tr>
<tr class="odd">
<td><p><strong>Fatalities</strong></p>
<ul>
<li><strong>fatalities:</strong>&nbsp;tracks the number of reported fatalities associated with each conflict event</li>
</ul></td>
</tr>
<tr class="even">
<td><p><strong>Others</strong></p>
<ul>
<li><strong>source:</strong> source of information for the conflict event</li>
<li><strong>source_scale:</strong> scale of the source e.g.&nbsp;local, national, international</li>
<li><strong>notes :</strong> additional comments</li>
<li><strong>tags:</strong> keywords associated with the conflict event</li>
<li><strong>timestamp:</strong> date and time when conflict event was entered/updated in the database</li>
</ul></td>
</tr>
</tbody>
</table>
</section>
<section id="geospatial-data-from-myanmar-information-management-unit" class="level4">
<h4 class="anchored" data-anchor-id="geospatial-data-from-myanmar-information-management-unit"><strong>2) Geospatial Data</strong> (<strong>From Myanmar Information Management Unit)</strong></h4>
<p>I will also be using a geospatial dataset from the Myanmar Information Management Unit (MIMU) in shapefile (.shp) format, specifically of the Myanmar state at the 2<sup>nd</sup> administrative level with district boundaries.</p>
<p><strong>🔗 Source:</strong> <a href="https://geonode.themimu.info/layers/geonode%3Ammr_polbnda_adm2_250k_mimu">MIMU</a></p>
<p><strong>📁 Format:</strong> shapefile (.shp)</p>
<p>My reasoning for choosing the <strong>district boundary</strong> dataset is that we do not want to select a boundary dataset that is too broad when analysing conflict events since it <strong>might not provide sufficient insights to trends</strong> where conflict events happen. Neither do we want to analyse a geography that is too divided (e.g.&nbsp;Admin 3) since it can be <strong>computationally inefficient</strong> as seen in the types of boundary data below.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 19%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Admin 0</th>
<th style="text-align: center;">Admin 1</th>
<th style="text-align: center;">Admin 1</th>
<th style="text-align: center;">Admin 2 - To Use</th>
<th style="text-align: center;">Admin 3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">National boundary</td>
<td style="text-align: center;">Myanmar region</td>
<td style="text-align: center;">Region and sub-region</td>
<td style="text-align: center;">District boundary</td>
<td style="text-align: center;">Myanmar township</td>
</tr>
<tr class="even">
<td style="text-align: center;"><img src="images/clipboard-4062665913.png" class="img-fluid"></td>
<td style="text-align: center;"><img src="images/clipboard-799910136.png" class="img-fluid"></td>
<td style="text-align: center;"><img src="images/clipboard-3525847239.png" class="img-fluid"></td>
<td style="text-align: center;"><img src="images/clipboard-1135072014.png" class="img-fluid"></td>
<td style="text-align: center;"><img src="images/clipboard-204520723.png" class="img-fluid"></td>
</tr>
</tbody>
</table>
<p>I have donwloaded the two data sets and organised them into my folder as follows.</p>
<p><img src="images/clipboard-4213243167.png" class="img-fluid" width="793"></p>
</section>
</section>
</section>
<section id="lets-set-up" class="level2">
<h2 class="anchored" data-anchor-id="lets-set-up"><strong>2. Let’s Set Up!</strong></h2>
<section id="importing-libraries-into-r" class="level3">
<h3 class="anchored" data-anchor-id="importing-libraries-into-r"><strong>2.1 Importing Libraries into R</strong></h3>
<p>To carry out this exercise, I will be using the following R packages:</p>
<ul>
<li><strong>sf</strong>: a relatively new R package specially designed to import, manage and process vector-based geospatial data in R.</li>
<li><strong>spatstat</strong>: has a wide range of useful functions for point pattern analysis. In this take-home exercise, it will be used to perform 1st- and 2nd-order spatial point patterns analysis and derive kernel density estimation (KDE) layer.</li>
<li><strong>raster</strong>: reads, writes, manipulates, analyses and model of gridded spatial data (i.e.&nbsp;raster). In this take-home exercise, it will be used to convert image output generate by spatstat into raster format.</li>
<li><strong>maptools</strong>: provides a set of tools for manipulating geographic data. We mainly use it to convert Spatial objects into ppp format of spatstat.</li>
<li><strong>tmap</strong>: provides functions for plotting cartographic quality static point patterns maps or interactive maps by using leaflet API.</li>
</ul>
<p>Now, let’s install and load these packages in RStudio.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf, raster, spatstat, tmap, tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="importing-data-sets-into-r" class="level3">
<h3 class="anchored" data-anchor-id="importing-data-sets-into-r"><strong>2.2 Importing Data Sets into R</strong></h3>
<section id="armed-conflicts-data" class="level4">
<h4 class="anchored" data-anchor-id="armed-conflicts-data">1) Armed Conflicts Data</h4>
<p>Next, I will import the downloaded armed conflict data. For aspatial datasets like this<em>,</em> we will import into Rstudio using <code>read_csv()</code> function of the <strong>readr</strong> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import armed conflict data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>conflict_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/2021-01-01-2024-06-30-Myanmar.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 87746 Columns: 28
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (18): event_id_cnty, event_date, disorder_type, event_type, sub_event_ty...
dbl (10): year, time_precision, inter1, interaction, iso, latitude, longitud...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <code>2021-01-01-2024-06-30-Myanmar.csv</code> dataset contains 87746 rows and 28 columns which indicates the presence of 87746 unique armed conflict events in Myanmar.</p>
</div>
</div>
<p>After importing the dataset, we can inspect the dataset using the <strong><code>glimpse()</code></strong> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect the conflict data</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(conflict_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 87,746
Columns: 28
$ event_id_cnty      &lt;chr&gt; "MMR64313", "MMR64313", "MMR64320", "MMR64320", "MM…
$ event_date         &lt;chr&gt; "30 June 2024", "30 June 2024", "30 June 2024", "30…
$ year               &lt;dbl&gt; 2024, 2024, 2024, 2024, 2024, 2024, 2024, 2024, 202…
$ time_precision     &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ disorder_type      &lt;chr&gt; "Political violence", "Political violence", "Politi…
$ event_type         &lt;chr&gt; "Battles", "Battles", "Battles", "Battles", "Battle…
$ sub_event_type     &lt;chr&gt; "Armed clash", "Armed clash", "Armed clash", "Armed…
$ actor1             &lt;chr&gt; "People's Defense Force - Mandalay", "Military Forc…
$ assoc_actor_1      &lt;chr&gt; "MDA - AGF: Madaya - The Authentic Genes Force; SST…
$ inter1             &lt;dbl&gt; 3, 1, 3, 1, 3, 1, 1, 3, 1, 1, 1, 2, 2, 1, 1, 2, 1, …
$ interaction        &lt;dbl&gt; 13, 13, 13, 13, 13, 13, 10, 13, 13, 10, 12, 12, 12,…
$ civilian_targeting &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ iso                &lt;dbl&gt; 104, 104, 104, 104, 104, 104, 104, 104, 104, 104, 1…
$ region             &lt;chr&gt; "Southeast Asia", "Southeast Asia", "Southeast Asia…
$ country            &lt;chr&gt; "Myanmar", "Myanmar", "Myanmar", "Myanmar", "Myanma…
$ admin1             &lt;chr&gt; "Mandalay", "Mandalay", "Mandalay", "Mandalay", "Ma…
$ admin2             &lt;chr&gt; "Mandalay", "Mandalay", "Pyinoolwin", "Pyinoolwin",…
$ admin3             &lt;chr&gt; "Patheingyi", "Patheingyi", "Singu", "Singu", "Thab…
$ location           &lt;chr&gt; "Aung Tha Pyay", "Aung Tha Pyay", "Pin Lel Gyi", "P…
$ latitude           &lt;dbl&gt; 22.1504, 22.1504, 22.5752, 22.5752, 22.8800, 22.880…
$ longitude          &lt;dbl&gt; 96.2364, 96.2364, 96.0661, 96.0661, 95.9700, 95.970…
$ geo_precision      &lt;dbl&gt; 2, 2, 1, 1, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 2, 2, 1, …
$ source             &lt;chr&gt; "Democratic Voice of Burma; Irrawaddy", "Democratic…
$ source_scale       &lt;chr&gt; "National", "National", "National", "National", "Na…
$ notes              &lt;chr&gt; "On 30 June 2024, near Aung Tha Pyay village (Pathe…
$ fatalities         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 0, 0, 0, …
$ tags               &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ timestamp          &lt;dbl&gt; 1720552468, 1720552468, 1720552468, 1720552468, 172…</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">
<p>The event_date field shows that it uses a character datatype instead of date - we will fix this later. Also, we can observe that the<strong><code>longitude</code></strong> and <strong><code>langitude</code></strong> fields appear to be adopting the <strong>WGS84 geographic</strong> coordinate system since they are in the -180/180 and -90/90 range respectively.</p>
</div>
</div>
</section>
<section id="myanmar-boundary-data" class="level4">
<h4 class="anchored" data-anchor-id="myanmar-boundary-data">2) Myanmar Boundary Data</h4>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">
<p>When working with Myanmar’s boundary, we need to assign the appropriate coordinate reference system. However, since Myanmar is split into <strong>two UTM</strong> - West Myanmar (crs: 32646) and East Myanmar (crs: 32647).</p>
</div>
</div>
<p>Hence, I will also import the administrative boundary data into a simple features tibble data.frame using&nbsp;<a href="https://r-spatial.github.io/sf/reference/st_read.html"><em>st_read()</em></a>&nbsp;of the <strong>sf</strong> package and <strong>check the number of rows returned for both CRS 32646 and 32647</strong>. This function reads the shapefile data and returns an&nbsp;<strong><code>sf</code></strong>&nbsp;object that can be used for further analysis.</p>
<div class="cell">
<details class="code-fold">
<summary>Find out conflicts count by CRS</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>conflict_crs <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(conflict_data, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"longitude"</span>, <span class="st">"latitude"</span>), <span class="at">crs =</span> <span class="dv">4326</span>) </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Count number of conflicts for CRS 32646</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>conflict_data_32646 <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(conflict_crs, <span class="at">crs =</span> <span class="dv">32646</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>count_32646 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(conflict_data_32646)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Count number of conflicts for CRS 32647</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>conflict_data_32647 <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(conflict_crs, <span class="at">crs =</span> <span class="dv">32647</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>count_32647 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(conflict_data_32647)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>crs_counts <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">CRS =</span> <span class="fu">c</span>(<span class="st">"EPSG: 32646"</span>, <span class="st">"EPSG: 32647"</span>),</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Conflicts_Count =</span> <span class="fu">c</span>(count_32646, count_32647)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(crs_counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          CRS Conflicts_Count
1 EPSG: 32646           87746
2 EPSG: 32647           87746</code></pre>
</div>
</div>
<p>Since there is no difference in the count, I will decide to focus on <strong>UTM zone 47N (EPSG:32647),</strong> east of Myanmar, for the purpose of this exercise<strong>.</strong> The <strong><code>st_transform()</code></strong> function below converts the CRS of the <strong><code>sf</code></strong> object to EPSG:32647.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import boundary data</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>boundary_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>,<span class="at">layer =</span> <span class="st">"mmr_polbnda_adm2_250k_mimu"</span>) <span class="sc">%&gt;%</span> <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">32647</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `mmr_polbnda_adm2_250k_mimu' from data source 
  `C:\SamanthaxFoo\IS415-GAA\Take-home_Ex\Take-home_Ex1\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 80 features and 7 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<p>In the code below, we can notice that the ESPG code has been updated to <strong>32647</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for changes</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(boundary_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: EPSG:32647 
  wkt:
PROJCRS["WGS 84 / UTM zone 47N",
    BASEGEOGCRS["WGS 84",
        ENSEMBLE["World Geodetic System 1984 ensemble",
            MEMBER["World Geodetic System 1984 (Transit)"],
            MEMBER["World Geodetic System 1984 (G730)"],
            MEMBER["World Geodetic System 1984 (G873)"],
            MEMBER["World Geodetic System 1984 (G1150)"],
            MEMBER["World Geodetic System 1984 (G1674)"],
            MEMBER["World Geodetic System 1984 (G1762)"],
            MEMBER["World Geodetic System 1984 (G2139)"],
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]],
            ENSEMBLEACCURACY[2.0]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]],
        ID["EPSG",4326]],
    CONVERSION["UTM zone 47N",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",0,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",99,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",0.9996,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",500000,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",0,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["(E)",east,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["(N)",north,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    USAGE[
        SCOPE["Navigation and medium accuracy spatial referencing."],
        AREA["Between 96°E and 102°E, northern hemisphere between equator and 84°N, onshore and offshore. China. Indonesia. Laos. Malaysia - West Malaysia. Mongolia. Myanmar (Burma). Russian Federation. Thailand."],
        BBOX[0,96,84,102]],
    ID["EPSG",32647]]</code></pre>
</div>
</div>
<p>Here, I will use the&nbsp;<strong><code>plot()</code></strong>&nbsp;function which plots the geometry of the&nbsp;<strong><code>sf</code></strong>&nbsp;object. The&nbsp;<strong><code>st_geometry()</code></strong>&nbsp;function is used to extract the geometry of the&nbsp;<strong><code>mpsz_sf</code></strong>&nbsp;object which includes the districts of Myanmar as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(boundary_sf))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="data-wrangling">3. Data Wrangling</h2>
<section id="fixing-incorrect-datatypes" class="level3">
<h3 class="anchored" data-anchor-id="fixing-incorrect-datatypes">3.1 Fixing Incorrect Datatypes</h3>
<p>Recall that the earlier inspection of the <code>conflict_data</code> tibble data frame revealed that the datatype indicated for event date is wrongly labelled as a character instead of a date format.</p>
<p>As such, let’s convert the datatype to the correct ‘date’ format as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the datatype for event_date</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>conflict_data<span class="sc">$</span>event_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(conflict_data<span class="sc">$</span>event_date, <span class="at">format =</span> <span class="st">"%d %B %Y"</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for changes</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(conflict_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 28
  event_id_cnty event_date  year time_precision disorder_type      event_type
  &lt;chr&gt;         &lt;date&gt;     &lt;dbl&gt;          &lt;dbl&gt; &lt;chr&gt;              &lt;chr&gt;     
1 MMR64313      2024-06-30  2024              1 Political violence Battles   
2 MMR64313      2024-06-30  2024              1 Political violence Battles   
3 MMR64320      2024-06-30  2024              1 Political violence Battles   
4 MMR64320      2024-06-30  2024              1 Political violence Battles   
5 MMR64321      2024-06-30  2024              1 Political violence Battles   
6 MMR64321      2024-06-30  2024              1 Political violence Battles   
# ℹ 22 more variables: sub_event_type &lt;chr&gt;, actor1 &lt;chr&gt;, assoc_actor_1 &lt;chr&gt;,
#   inter1 &lt;dbl&gt;, interaction &lt;dbl&gt;, civilian_targeting &lt;chr&gt;, iso &lt;dbl&gt;,
#   region &lt;chr&gt;, country &lt;chr&gt;, admin1 &lt;chr&gt;, admin2 &lt;chr&gt;, admin3 &lt;chr&gt;,
#   location &lt;chr&gt;, latitude &lt;dbl&gt;, longitude &lt;dbl&gt;, geo_precision &lt;dbl&gt;,
#   source &lt;chr&gt;, source_scale &lt;chr&gt;, notes &lt;chr&gt;, fatalities &lt;dbl&gt;,
#   tags &lt;chr&gt;, timestamp &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="adding-new-year_quarter-column" class="level3">
<h3 class="anchored" data-anchor-id="adding-new-year_quarter-column">3.2 Adding new year_quarter column</h3>
<p>We will want to create a new column to indicate the specific year and quarter for each conflict event since the spatial analysis will be done later in a quarterly manner.</p>
<div class="cell">
<details class="code-fold">
<summary>Extract year and quarter</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>conflict_data<span class="sc">$</span>year_quarter <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">year</span>(conflict_data<span class="sc">$</span>event_date), </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">" Q"</span>, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quarter</span>(conflict_data<span class="sc">$</span>event_date)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># View the new data column</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(conflict_data<span class="sc">$</span>year_quarter)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "2024 Q2" "2024 Q1" "2023 Q4" "2023 Q3" "2023 Q2" "2023 Q1" "2022 Q4"
 [8] "2022 Q3" "2022 Q2" "2022 Q1" "2021 Q4" "2021 Q3" "2021 Q2" "2021 Q1"</code></pre>
</div>
</div>
</section>
<section id="fixing-duplicated-event-id-in-conflict_data-dataframe" class="level3">
<h3 class="anchored" data-anchor-id="fixing-duplicated-event-id-in-conflict_data-dataframe">3.3 Fixing Duplicated Event ID in <em>conflict_data</em> Dataframe</h3>
<p>As shown, there are presence of duplicates in our dataframe returned by the <strong><code>duplicated()</code></strong> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for duplicates</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(conflict_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>Based on the duplicated <strong>event ID: MMR64313</strong> for instance. We can observe the two records are of the <strong>same</strong> political violence event happening between <strong>two</strong> <strong>actors</strong> on 30/6/2024, between the People’s Defense Force and Military Forces of Myanmar. Upon further research, these two actors are <strong>opposing political parties</strong> of Myanmar’s ongoing conflict.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect an instance of the duplciated event IDs</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(conflict_data,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 29
  event_id_cnty event_date  year time_precision disorder_type      event_type
  &lt;chr&gt;         &lt;date&gt;     &lt;dbl&gt;          &lt;dbl&gt; &lt;chr&gt;              &lt;chr&gt;     
1 MMR64313      2024-06-30  2024              1 Political violence Battles   
2 MMR64313      2024-06-30  2024              1 Political violence Battles   
# ℹ 23 more variables: sub_event_type &lt;chr&gt;, actor1 &lt;chr&gt;, assoc_actor_1 &lt;chr&gt;,
#   inter1 &lt;dbl&gt;, interaction &lt;dbl&gt;, civilian_targeting &lt;chr&gt;, iso &lt;dbl&gt;,
#   region &lt;chr&gt;, country &lt;chr&gt;, admin1 &lt;chr&gt;, admin2 &lt;chr&gt;, admin3 &lt;chr&gt;,
#   location &lt;chr&gt;, latitude &lt;dbl&gt;, longitude &lt;dbl&gt;, geo_precision &lt;dbl&gt;,
#   source &lt;chr&gt;, source_scale &lt;chr&gt;, notes &lt;chr&gt;, fatalities &lt;dbl&gt;,
#   tags &lt;chr&gt;, timestamp &lt;dbl&gt;, year_quarter &lt;chr&gt;</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Reflection">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Reflection
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Should duplicated data be removed in this analysis?</strong></p>
<p>A <strong>single event</strong> (e.g.&nbsp;MMR64313) can have duplicated rows <strong>with different actor1 values</strong>, typically due to counterattacks from opposing sides, leading to different data entries into the <strong><code>conflict_data</code></strong> dataset.</p>
<p>Hence, I will <strong>remove duplicated events</strong> found in the <strong><code>conflict_data</code></strong> dataframe as long as the rows have the same event ID indicated.</p>
</div>
</div>
<p>Here, I did another check to ensure there is <strong>not more than 2 possible repeated event IDs</strong> in the first 20 rows of <strong>conflict_data</strong>.</p>
<div class="cell">
<details class="code-fold">
<summary>Check duplicated events for first 20 rows</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>duplicate_counts_first_20 <span class="ot">&lt;-</span> conflict_data <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>) <span class="sc">%&gt;%</span>            </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(event_id_cnty) <span class="sc">%&gt;%</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span>  </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(count <span class="sc">&gt;</span> <span class="dv">1</span>)         </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># View the result</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(duplicate_counts_first_20)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 2
  event_id_cnty count
  &lt;chr&gt;         &lt;int&gt;
1 MMR64313          2
2 MMR64320          2
3 MMR64321          2
4 MMR64323          2
5 MMR64325          2
6 MMR64326          2
7 MMR64328          2
8 MMR64330          2
9 MMR64331          2</code></pre>
</div>
</div>
<p>With that checked, I’ll remove the duplicated rows with a repeated Event ID.</p>
<div class="cell">
<details class="code-fold">
<summary>Remove duplicated rows</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve data of duplicated rows</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>merged_duplicates <span class="ot">&lt;-</span> conflict_data <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">duplicated</span>(event_id_cnty) <span class="sc">|</span> <span class="fu">duplicated</span>(event_id_cnty, <span class="at">fromLast =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(event_id_cnty) <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(event_id_cnty) <span class="sc">%&gt;%</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">actor2 =</span> <span class="fu">last</span>(actor1),</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">assoc_actor_2 =</span> <span class="fu">last</span>(assoc_actor_1)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>conflict_data_no_duplicates <span class="ot">&lt;-</span> conflict_data <span class="sc">%&gt;%</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">duplicated</span>(event_id_cnty))</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Update conflict_data dataframe with new columns</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>conflict_data <span class="ot">&lt;-</span> conflict_data_no_duplicates <span class="sc">%&gt;%</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(merged_duplicates, <span class="at">by =</span> <span class="st">"event_id_cnty"</span>)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="co"># View dataframe</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(conflict_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 31
  event_id_cnty event_date  year time_precision disorder_type         event_type
  &lt;chr&gt;         &lt;date&gt;     &lt;dbl&gt;          &lt;dbl&gt; &lt;chr&gt;                 &lt;chr&gt;     
1 MMR64313      2024-06-30  2024              1 Political violence    Battles   
2 MMR64320      2024-06-30  2024              1 Political violence    Battles   
3 MMR64321      2024-06-30  2024              1 Political violence    Battles   
4 MMR64322      2024-06-30  2024              1 Strategic developmen… Strategic…
5 MMR64323      2024-06-30  2024              1 Political violence    Battles   
6 MMR64324      2024-06-30  2024              1 Strategic developmen… Strategic…
# ℹ 25 more variables: sub_event_type &lt;chr&gt;, actor1 &lt;chr&gt;, assoc_actor_1 &lt;chr&gt;,
#   inter1 &lt;dbl&gt;, interaction &lt;dbl&gt;, civilian_targeting &lt;chr&gt;, iso &lt;dbl&gt;,
#   region &lt;chr&gt;, country &lt;chr&gt;, admin1 &lt;chr&gt;, admin2 &lt;chr&gt;, admin3 &lt;chr&gt;,
#   location &lt;chr&gt;, latitude &lt;dbl&gt;, longitude &lt;dbl&gt;, geo_precision &lt;dbl&gt;,
#   source &lt;chr&gt;, source_scale &lt;chr&gt;, notes &lt;chr&gt;, fatalities &lt;dbl&gt;,
#   tags &lt;chr&gt;, timestamp &lt;dbl&gt;, year_quarter &lt;chr&gt;, actor2 &lt;chr&gt;,
#   assoc_actor_2 &lt;chr&gt;</code></pre>
</div>
</div>
<p>We can observe that there are no longer any duplicated event IDs in our <strong><code>conflict_data</code></strong> data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(conflict_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
</section>
<section id="converting-aspatial-data-to-simple-feature-format" class="level3">
<h3 class="anchored" data-anchor-id="converting-aspatial-data-to-simple-feature-format">3.4 Converting Aspatial Data to Simple Feature Format</h3>
<p>For the purpose of this exercise, we will want to integrate and analyse aspatial data in a geographic context. I’ll do a check if <strong><code>conflict_data</code></strong> needs to be converted to a <strong>sf data frame</strong> - if it outputs anything else but <code>sf</code>, then it’s not a simple feature data frame!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(conflict_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "spec_tbl_df" "tbl_df"      "tbl"         "data.frame" </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">
<p>We can see that <strong><code>conflict_data</code></strong> is <strong>not</strong> a sf data frame. Since a non-simple feature data frame does not have a “geometry” column, we’ll need to convert <strong><code>conflict_data</code></strong> into a <strong>simple feature</strong> data frame</p>
</div>
</div>
<p>We can convert <strong><code>conflict_data</code></strong> into a <strong>simple feature</strong> data frame by using&nbsp;<strong><code>st_as_sf()</code></strong>&nbsp;from the&nbsp;<strong>sf</strong>&nbsp;package. Addiitionally, we will also need to transform coordinate system from geographic <strong>(ESPG: 4326)</strong> to projected <strong>(ESPG: 32647)</strong> using <strong><code>st_transform()</code></strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to simple feature format</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>conflict_data_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(conflict_data, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"longitude"</span>, <span class="st">"latitude"</span>), <span class="at">crs=</span><span class="dv">4326</span>) <span class="sc">%&gt;%</span> <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">32647</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect the changes</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(conflict_data_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 51,553
Columns: 30
$ event_id_cnty      &lt;chr&gt; "MMR64313", "MMR64320", "MMR64321", "MMR64322", "MM…
$ event_date         &lt;date&gt; 2024-06-30, 2024-06-30, 2024-06-30, 2024-06-30, 20…
$ year               &lt;dbl&gt; 2024, 2024, 2024, 2024, 2024, 2024, 2024, 2024, 202…
$ time_precision     &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ disorder_type      &lt;chr&gt; "Political violence", "Political violence", "Politi…
$ event_type         &lt;chr&gt; "Battles", "Battles", "Battles", "Strategic develop…
$ sub_event_type     &lt;chr&gt; "Armed clash", "Armed clash", "Armed clash", "Chang…
$ actor1             &lt;chr&gt; "People's Defense Force - Mandalay", "People's Defe…
$ assoc_actor_1      &lt;chr&gt; "MDA - AGF: Madaya - The Authentic Genes Force; SST…
$ inter1             &lt;dbl&gt; 3, 3, 3, 1, 3, 1, 1, 2, 1, 1, 1, 1, 3, 3, 3, 7, 1, …
$ interaction        &lt;dbl&gt; 13, 13, 13, 10, 13, 10, 12, 12, 12, 12, 12, 13, 13,…
$ civilian_targeting &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ iso                &lt;dbl&gt; 104, 104, 104, 104, 104, 104, 104, 104, 104, 104, 1…
$ region             &lt;chr&gt; "Southeast Asia", "Southeast Asia", "Southeast Asia…
$ country            &lt;chr&gt; "Myanmar", "Myanmar", "Myanmar", "Myanmar", "Myanma…
$ admin1             &lt;chr&gt; "Mandalay", "Mandalay", "Mandalay", "Sagaing", "Sag…
$ admin2             &lt;chr&gt; "Mandalay", "Pyinoolwin", "Pyinoolwin", "Shwebo", "…
$ admin3             &lt;chr&gt; "Patheingyi", "Singu", "Thabeikkyin", "Khin-U", "My…
$ location           &lt;chr&gt; "Aung Tha Pyay", "Pin Lel Gyi", "Thabeikkyin", "Khi…
$ geo_precision      &lt;dbl&gt; 2, 1, 2, 2, 2, 2, 1, 1, 2, 1, 1, 2, 1, 1, 2, 2, 1, …
$ source             &lt;chr&gt; "Democratic Voice of Burma; Irrawaddy", "Irrawaddy"…
$ source_scale       &lt;chr&gt; "National", "National", "National", "Subnational-Na…
$ notes              &lt;chr&gt; "On 30 June 2024, near Aung Tha Pyay village (Pathe…
$ fatalities         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ tags               &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ timestamp          &lt;dbl&gt; 1720552468, 1720552468, 1720552468, 1720552468, 172…
$ year_quarter       &lt;chr&gt; "2024 Q2", "2024 Q2", "2024 Q2", "2024 Q2", "2024 Q…
$ actor2             &lt;chr&gt; "Military Forces of Myanmar (2021-)", "Military For…
$ assoc_actor_2      &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "Uniden…
$ geometry           &lt;POINT [m]&gt; POINT (214961 2452068), POINT (198303.2 24994…</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">
<p>Notice that a new column called&nbsp;<code>geometry</code>&nbsp;has been added into the data frame. On the other hand, the&nbsp;<code>longitude</code>&nbsp;and&nbsp;<code>latitude</code>&nbsp;columns have been removed from the data frame.</p>
</div>
</div>
<p>We can further inspect the newly created ‘geometry’ column of <strong><code>conflict_data_sf</code></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve geometry column</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">st_geometry</span>(conflict_data_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Geometry set for 51553 features 
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: -208804.4 ymin: 1103500 xmax: 640934.5 ymax: 3042960
Projected CRS: WGS 84 / UTM zone 47N
First 5 geometries:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>POINT (214961 2452068)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>POINT (198303.2 2499463)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>POINT (189105.4 2533434)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>POINT (160913.9 2522331)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>POINT (146213 2428487)</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">
<p>It consists of <strong>51,533 features</strong> consisting of <strong>point</strong> <strong>geometric features</strong> where the underlying datum is in WGS 84 format.</p>
</div>
</div>
<p>To ensure that the coordinate system is correctly updated, we can use the <strong><code>st_crs()</code></strong> function where we observe that the ESPG code is correctly indicated as <strong>32647</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check CRS format</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(conflict_data_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: EPSG:32647 
  wkt:
PROJCRS["WGS 84 / UTM zone 47N",
    BASEGEOGCRS["WGS 84",
        ENSEMBLE["World Geodetic System 1984 ensemble",
            MEMBER["World Geodetic System 1984 (Transit)"],
            MEMBER["World Geodetic System 1984 (G730)"],
            MEMBER["World Geodetic System 1984 (G873)"],
            MEMBER["World Geodetic System 1984 (G1150)"],
            MEMBER["World Geodetic System 1984 (G1674)"],
            MEMBER["World Geodetic System 1984 (G1762)"],
            MEMBER["World Geodetic System 1984 (G2139)"],
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]],
            ENSEMBLEACCURACY[2.0]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]],
        ID["EPSG",4326]],
    CONVERSION["UTM zone 47N",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",0,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",99,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",0.9996,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",500000,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",0,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["(E)",east,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["(N)",north,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    USAGE[
        SCOPE["Navigation and medium accuracy spatial referencing."],
        AREA["Between 96°E and 102°E, northern hemisphere between equator and 84°N, onshore and offshore. China. Indonesia. Laos. Malaysia - West Malaysia. Mongolia. Myanmar (Burma). Russian Federation. Thailand."],
        BBOX[0,96,84,102]],
    ID["EPSG",32647]]</code></pre>
</div>
</div>
</section>
<section id="reduce-data-file-size" class="level3">
<h3 class="anchored" data-anchor-id="reduce-data-file-size">3.5 Reduce Data File Size</h3>
<p>In this section, I will reduce the current Myanmar armed conflict dataset as the time taken for computing the kernel density estimates can take up to 30 minutes long which is not computationally efficient.</p>
<section id="remove-protests-and-riots-event-types" class="level4">
<h4 class="anchored" data-anchor-id="remove-protests-and-riots-event-types"><strong>1) Remove ‘Protests’ and ‘Riots’ Event Types</strong></h4>
<p>I will remove rows in the <strong><code>conflicts_data_sf</code></strong> dataset that don’t focus on the four main event types (Battles, Explosion/Remote violence, Strategic developments, and Violence against civilians), as mentioned in the exercise brief.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>conflict_data_sf <span class="ot">&lt;-</span> conflict_data_sf <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(event_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Protests"</span>, <span class="st">"Riots"</span>)))</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(conflict_data_sf<span class="sc">$</span>event_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Battles"                    "Strategic developments"    
[3] "Violence against civilians" "Explosions/Remote violence"</code></pre>
</div>
</div>
</section>
<section id="remove-unused-columns-in-boundary_sf" class="level4">
<h4 class="anchored" data-anchor-id="remove-unused-columns-in-boundary_sf"><strong>2) Remove unused columns in boundary_sf</strong></h4>
<p>As seen, there are <strong>8 columns</strong> in the simple feature data frame of <strong><code>boundary_sf</code></strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect first rows of data in boundary_sf</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(boundary_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 6 features and 7 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -14915.04 ymin: 1736124 xmax: 187961.7 ymax: 2051144
Projected CRS: WGS 84 / UTM zone 47N
  OBJECTID         ST ST_PCODE        DT   DT_PCODE      DT_MMR PCode_V
1        1 Ayeyarwady   MMR017  Hinthada MMR017D002    ဟင်္သာတခရိုင်     9.4
2        2 Ayeyarwady   MMR017   Labutta MMR017D004    လပွတ္တာခရိုင်     9.4
3        3 Ayeyarwady   MMR017    Maubin MMR017D005     မအူပင်ခရိုင်     9.4
4        4 Ayeyarwady   MMR017 Myaungmya MMR017D003 မြောင်းမြခရိုင်     9.4
5        5 Ayeyarwady   MMR017   Pathein MMR017D001      ပုသိမ်ခရိုင်     9.4
6        6 Ayeyarwady   MMR017    Pyapon MMR017D006     ဖျာပုံခရိုင်     9.4
                        geometry
1 MULTIPOLYGON (((90859.89 20...
2 MULTIPOLYGON (((75991.51 17...
3 MULTIPOLYGON (((115559 1928...
4 MULTIPOLYGON (((39919.39 18...
5 MULTIPOLYGON (((-6302.348 1...
6 MULTIPOLYGON (((93411.72 17...</code></pre>
</div>
</div>
<p>I will remove <strong>’DT_MMR”</strong> column as we already have the District Name in English in <strong><code>DT</code></strong> and won’t require the district names in Myanmar Language. Next, we will remove the coded versions of <strong>ST (state/region)</strong> and <strong>DT (district)</strong> columns, namely <strong><code>ST_PCODE</code></strong> and <strong><code>DT_PCODE</code></strong>. Additionally, we won’t need the <strong><code>PCode_V</code></strong> column since we will be dropping the PCODE column too.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>boundary_sf <span class="ot">&lt;-</span> boundary_sf <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">'OBJECTID'</span>, <span class="st">'ST'</span>, <span class="st">'DT'</span>,<span class="st">'geometry'</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(boundary_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    OBJECTID          ST                 DT                     geometry 
 Min.   : 1.00   Length:80          Length:80          MULTIPOLYGON :80  
 1st Qu.:20.75   Class :character   Class :character   epsg:32647   : 0  
 Median :40.50   Mode  :character   Mode  :character   +proj=utm ...: 0  
 Mean   :40.50                                                           
 3rd Qu.:60.25                                                           
 Max.   :80.00                                                           </code></pre>
</div>
</div>
</section>
<section id="remove-unused-columns-in-conflict_data" class="level4">
<h4 class="anchored" data-anchor-id="remove-unused-columns-in-conflict_data"><strong>3) Remove unused columns in conflict_data</strong></h4>
<p>I will also remove unnecessary columns of the <strong><code>conflict_data</code></strong> data frame that won’t be used in our spatial analysis later.</p>
<div class="cell">
<details class="code-fold">
<summary>Remove unnecessary columns</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>conflict_data_sf <span class="ot">&lt;-</span> conflict_data_sf <span class="sc">%&gt;%</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(event_id_cnty, event_date, year_quarter, disorder_type, event_type, location, geometry, fatalities)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(conflict_data_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> event_id_cnty        event_date         year_quarter       disorder_type     
 Length:42608       Min.   :2021-01-01   Length:42608       Length:42608      
 Class :character   1st Qu.:2022-01-10   Class :character   Class :character  
 Mode  :character   Median :2022-10-13   Mode  :character   Mode  :character  
                    Mean   :2022-10-29                                        
                    3rd Qu.:2023-08-29                                        
                    Max.   :2024-06-30                                        
  event_type          location                  geometry       fatalities    
 Length:42608       Length:42608       POINT        :42608   Min.   :  0.00  
 Class :character   Class :character   epsg:32647   :    0   1st Qu.:  0.00  
 Mode  :character   Mode  :character   +proj=utm ...:    0   Median :  0.00  
                                                             Mean   :  1.27  
                                                             3rd Qu.:  1.00  
                                                             Max.   :201.00  </code></pre>
</div>
</div>
<p>Let’s append <strong><code>conflict_data_sf</code></strong> with the columns of <strong><code>boundary_sf</code></strong> to assist our analysis later.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Link conflict event to its district region</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>conflict_data_sf <span class="ot">&lt;-</span> <span class="fu">st_join</span>(conflict_data_sf, boundary_sf, <span class="at">join =</span> st_intersects)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="converting-simple-features-data-frame-into-ppp-object" class="level3">
<h3 class="anchored" data-anchor-id="converting-simple-features-data-frame-into-ppp-object">3.6 Converting Simple Features Data Frame into ppp Object</h3>
<p>It is important that we convert <strong><code>conflict_data_sf</code></strong> (a simple feature data frame) into a <strong>planer point pattern (ppp)</strong> object format, since the <strong><code>spatstat</code></strong> package that we’ll be using for the Spatial Point Pattern Analysis later is specifically designed for working with <strong>ppp-formated</strong> data. Additionally, I will begin with <strong>categorising the ppp objects</strong> into their <strong>unique <code>year_quarter</code></strong> <strong>category</strong>.</p>
<div class="cell">
<details class="code-fold">
<summary>Create ppp objects based on year_quarter category</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an empty list to store the ppp objects</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>ppp_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each unique year_quarter category</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (yq <span class="cf">in</span> <span class="fu">unique</span>(conflict_data_sf<span class="sc">$</span>year_quarter)) {</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current year_quarter</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  subset_data_sf <span class="ot">&lt;-</span> conflict_data_sf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year_quarter <span class="sc">==</span> yq)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert the subset to a ppp object</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  subset_ppp <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(subset_data_sf<span class="sc">$</span>geometry)</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add the ppp object to the list</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>  ppp_list[[yq]] <span class="ot">&lt;-</span> subset_ppp</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Check list</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>ppp_list</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`2024 Q2`
Planar point pattern: 2788 points
window: rectangle = [-208804.4, 597543.7] x [1103500.1, 3026504.9] units

$`2024 Q1`
Planar point pattern: 3186 points
window: rectangle = [-207135, 591875.9] x [1245380, 3026504.9] units

$`2023 Q4`
Planar point pattern: 3627 points
window: rectangle = [-206931.7, 604775.1] x [1103500.1, 3020772.2] units

$`2023 Q3`
Planar point pattern: 3010 points
window: rectangle = [-197883.4, 518300.4] x [1103500.1, 3027041.8] units

$`2023 Q2`
Planar point pattern: 2745 points
window: rectangle = [-191261.5, 518300.4] x [1103500.1, 3006372.9] units

$`2023 Q1`
Planar point pattern: 3101 points
window: rectangle = [-199243.8, 591875.9] x [1103500.1, 3026504.9] units

$`2022 Q4`
Planar point pattern: 3296 points
window: rectangle = [-206531.5, 518300.4] x [1103500.1, 2931517.1] units

$`2022 Q3`
Planar point pattern: 3486 points
window: rectangle = [-206196.6, 568361.5] x [1103500.1, 3026504.9] units

$`2022 Q2`
Planar point pattern: 3580 points
window: rectangle = [-206931.7, 640934.5] x [1103500.1, 3026504.9] units

$`2022 Q1`
Planar point pattern: 3563 points
window: rectangle = [-204784, 591875.9] x [1103500.1, 3026504.9] units

$`2021 Q4`
Planar point pattern: 3844 points
window: rectangle = [-200024.3, 591875.9] x [1103500.1, 3042960.3] units

$`2021 Q3`
Planar point pattern: 2754 points
window: rectangle = [-193181.1, 591875.9] x [1103500.1, 3042960.3] units

$`2021 Q2`
Planar point pattern: 2916 points
window: rectangle = [-191409.1, 640934.5] x [1132472.1, 3042960.3] units

$`2021 Q1`
Planar point pattern: 712 points
window: rectangle = [-203795.3, 591875.9] x [1375186.1, 3026504.9] units</code></pre>
</div>
</div>
<p>We can visualise the spread of conflict events across each quarter from January 2021 to June 2024 using the <strong><code>plot()</code></strong> function as shown below.</p>
<div class="cell">
<details class="code-fold">
<summary>Visualise the spread of conflicts by year_quarter</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure 'year_quarter' is a factor</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>conflict_data_sf<span class="sc">$</span>year_quarter <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(conflict_data_sf<span class="sc">$</span>year_quarter)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each unique year_quarter and create separate plots</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>year_quarters <span class="ot">&lt;-</span> <span class="fu">unique</span>(conflict_data_sf<span class="sc">$</span>year_quarter)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up a grid layout for multiple plots (adjust 'mfrow' as needed)</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>))</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each year_quarter and plot</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (yq <span class="cf">in</span> year_quarters) {</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  subset_data_sf <span class="ot">&lt;-</span> conflict_data_sf[conflict_data_sf<span class="sc">$</span>year_quarter <span class="sc">==</span> yq, ]</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>  conflict_data_ppp <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(subset_data_sf<span class="sc">$</span>geometry)</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot each subset ppp object</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(conflict_data_ppp, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Year-Quarter:"</span>, yq))</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-25-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-25-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">
<p>It is noticeable that there <strong>conflict events have occured more frequently</strong> since 2021 as points plotted on the graph have gotten darker across 2021 to 2024. We can also observe the <strong>possibility of duplicated events</strong> occurring from the darker spots in the plot, in which it appears more intense in Myanmar’s central and west regions.</p>
</div>
</div>
</section>
<section id="creating-owin-object" class="level3">
<h3 class="anchored" data-anchor-id="creating-owin-object">3.7 Creating <em>owin</em> object</h3>
<p>When analysing spatial point patterns, it is a good practice to confine the analysis with a geographical area, that is Myanmar’s boundary in this case. In <strong><code>spatstat</code></strong>, an object called <strong><code>owin</code></strong> is specially designed to represent this <strong>polygonal region</strong>.</p>
<p>The code chunk below is used to convert the <strong><code>boundary_data_sf</code></strong> simple feature data frame into an <strong><code>owin</code></strong> object of <strong><code>spatstat</code></strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to owin object</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>myanmar_owin <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(boundary_sf)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualise the owin object</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(myanmar_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">
<p>From my observations, the <strong><code>as.owin()</code></strong> function converts the <strong><code>boundary_data_sf</code></strong> spatial boundary into a window object that represents the outer boundary of the spatial region and does not handle internal structures or districts we previously saw from the plot of <strong><code>boundary_data_sf</code></strong><code>.</code></p>
</div>
</div>
<p>We can also take a quick look at the <strong><code>owin</code></strong> object properties as shown. I will be converting it to a data frame for the purposes of getting a quick glimpse of the object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary info of owin object</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>owin_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(myanmar_owin)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(owin_df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         x       y id sign
1 56519.39 2741919  1   -1
2 56917.28 2741947  1   -1
3 57000.15 2741973  1   -1
4 57068.51 2741994  1   -1
5 57221.44 2742142  1   -1
6 57068.51 2741994  1   -1</code></pre>
</div>
</div>
</section>
<section id="combining-ppp-object-and-owin-object" class="level3">
<h3 class="anchored" data-anchor-id="combining-ppp-object-and-owin-object"><strong>3.8 Combining ppp Object and owin Object</strong></h3>
<p>In this last step of geospatial data wrangling, I will <strong>mask all ppp object with the owin object</strong> I created earlier to put in place all conflict events within the boundary of Myanmar. Doing so can also optimise the memory usage for large datasets.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"></ul>
<div class="tab-content">

</div>
</div>
<p>The&nbsp;<strong><code>ppp</code></strong>&nbsp;object outputted from combining both the point and polygon feature results in the boundary of Myanmar outlining the plot of conflict events as shown.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up plotting layout</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(masked_ppp_list)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot each masked ppp object</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>))  <span class="co"># Adjust margins as needed</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (quarter <span class="cf">in</span> <span class="fu">names</span>(masked_ppp_list)) {</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(masked_ppp_list[[quarter]], <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Year Quarter:"</span>, quarter))</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-30-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-30-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="exploratory-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis">4. Exploratory Data Analysis</h2>
<section id="identifying-districts-with-highest-proportion-of-conflicts" class="level3">
<h3 class="anchored" data-anchor-id="identifying-districts-with-highest-proportion-of-conflicts">4.1 Identifying <em>Districts</em> with Highest Proportion of Conflicts</h3>
<p>It’ll also be interesting to find out <strong>specific districts</strong> with the <strong>highest concentration of armed conflicts.</strong> I will first calculate the total occurrences of conflict events per district and add the column to <strong><code>boundary_sf</code></strong>.</p>
<div class="cell">
<details class="code-fold">
<summary>Count number of conflicts by districts</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>conflict_count <span class="ot">&lt;-</span> conflict_data_sf <span class="sc">%&gt;%</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(DT) <span class="sc">%&gt;%</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_count_DT =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(DT, total_count_DT)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the join</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>boundary_sf <span class="ot">&lt;-</span> boundary_sf <span class="sc">%&gt;%</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(conflict_count, <span class="at">by =</span> <span class="st">"DT"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, let’s calculate the <strong>proportion</strong> of total conflicts and add it as a column into the <strong><code>boundary_sf</code></strong> dataset as <strong><code>proportion_DT</code></strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new 'proportion_DT' column</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>boundary_sf <span class="ot">&lt;-</span> boundary_sf <span class="sc">%&gt;%</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proportion_DT =</span> total_count_DT <span class="sc">/</span> <span class="fu">sum</span>(total_count_DT))</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(boundary_sf[<span class="fu">c</span>(<span class="st">'DT'</span>,<span class="st">'total_count_DT'</span>,<span class="st">'proportion_DT'</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 6 features and 3 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -14915.04 ymin: 1736124 xmax: 187961.7 ymax: 2051144
Projected CRS: WGS 84 / UTM zone 47N
         DT total_count_DT proportion_DT                       geometry
1  Hinthada            160   0.003755780 MULTIPOLYGON (((90859.89 20...
2   Labutta             51   0.001197155 MULTIPOLYGON (((75991.51 17...
3    Maubin            118   0.002769888 MULTIPOLYGON (((115559 1928...
4 Myaungmya             59   0.001384944 MULTIPOLYGON (((39919.39 18...
5   Pathein            333   0.007816718 MULTIPOLYGON (((-6302.348 1...
6    Pyapon            131   0.003075045 MULTIPOLYGON (((93411.72 17...</code></pre>
</div>
</div>
<p>At a quick glance, we can see that central and southern parts of Myanmar have the highest proportions of armed conflict events occuring.</p>
<div class="cell">
<details class="code-fold">
<summary>Set up the points map</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>districts_choropleth <span class="ot">&lt;-</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(boundary_sf) <span class="sc">+</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"proportion_DT"</span>,</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">n=</span><span class="dv">10</span>,</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title=</span><span class="st">"Proportion"</span>,</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">style=</span><span class="st">"equal"</span>,</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"Blues"</span>) <span class="sc">+</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">lwd=</span><span class="fl">0.2</span>,</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="at">text =</span> <span class="st">"DT"</span>, </span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="fl">0.2</span>, </span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Distribution of Conflict Points Across Districts"</span>,</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside=</span><span class="cn">FALSE</span>,</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the map</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(districts_choropleth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/clipboard-1636605006.png" class="img-fluid"></p>
<p>More specifically, we can observe that the district types are all unique for the <strong>top 3</strong> conflict areas and mainly found in the districts of <strong>Yinmarbin, Shwebo and Pakokku</strong> which lies in the central regions of Myanmar.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count number of conflicts by district</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>conflict_count <span class="ot">&lt;-</span> conflict_data_sf <span class="sc">%&gt;%</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(DT) <span class="sc">%&gt;%</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_count_DT =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(DT, total_count_DT)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the join</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>boundary_sf <span class="ot">&lt;-</span> boundary_sf <span class="sc">%&gt;%</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(conflict_count, <span class="at">by =</span> <span class="st">"DT"</span>)</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>conflict_count <span class="sc">%&gt;%</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_count_DT)) <span class="sc">%&gt;%</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   DT         total_count_DT
   &lt;chr&gt;               &lt;int&gt;
 1 Shwebo               2694
 2 Pakokku              2491
 3 Yinmarbin            1788
 4 Monywa               1514
 5 Kale                 1261
 6 Pyinoolwin           1261
 7 Muse                 1244
 8 Loikaw               1172
 9 Dawei                1165
10 Sagaing              1146</code></pre>
</div>
</div>
</section>
<section id="identifying-states-with-highest-proportion-of-conflicts" class="level3">
<h3 class="anchored" data-anchor-id="identifying-states-with-highest-proportion-of-conflicts">4.2 Identifying <em>States</em> with Highest Proportion of Conflicts</h3>
<p>Instead, let us also explore the <strong>top 10 states</strong> with the highest proportions of armed conflict events.</p>
<div class="cell">
<details class="code-fold">
<summary>Count number of conflicts by states</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>conflict_count <span class="ot">&lt;-</span> conflict_data_sf <span class="sc">%&gt;%</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ST) <span class="sc">%&gt;%</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_count_ST =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ST, total_count_ST)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the join</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>boundary_sf <span class="ot">&lt;-</span> boundary_sf <span class="sc">%&gt;%</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(conflict_count, <span class="at">by =</span> <span class="st">"ST"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Likewise, I’ll add a new column called <strong><code>proportion_ST</code></strong> to represent the proportion based on each Myanmar state.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>boundary_sf <span class="ot">&lt;-</span> boundary_sf <span class="sc">%&gt;%</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proportion_ST =</span> total_count_ST <span class="sc">/</span> <span class="fu">sum</span>(total_count_ST))</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(boundary_sf[<span class="fu">c</span>(<span class="st">'ST'</span>,<span class="st">'total_count_ST'</span>,<span class="st">'proportion_ST'</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 6 features and 3 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -14915.04 ymin: 1736124 xmax: 187961.7 ymax: 2051144
Projected CRS: WGS 84 / UTM zone 47N
          ST total_count_ST proportion_ST                       geometry
1 Ayeyarwady            852   0.003053731 MULTIPOLYGON (((90859.89 20...
2 Ayeyarwady            852   0.003053731 MULTIPOLYGON (((75991.51 17...
3 Ayeyarwady            852   0.003053731 MULTIPOLYGON (((115559 1928...
4 Ayeyarwady            852   0.003053731 MULTIPOLYGON (((39919.39 18...
5 Ayeyarwady            852   0.003053731 MULTIPOLYGON (((-6302.348 1...
6 Ayeyarwady            852   0.003053731 MULTIPOLYGON (((93411.72 17...</code></pre>
</div>
</div>
<p>At a quick glance, we can see that <strong>central</strong> and <strong>southern</strong> parts of Myanmar have the highest proportions of armed conflict events occurring, particularly in <strong>Sagaing</strong>, <strong>Mandalay</strong> and <strong>Magway</strong> states.</p>
<div class="cell">
<details class="code-fold">
<summary>Create the points map</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>states_choropleth <span class="ot">&lt;-</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(boundary_sf) <span class="sc">+</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"proportion_ST"</span>,</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">n=</span><span class="dv">10</span>,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title=</span><span class="st">"Proportion"</span>,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">style=</span><span class="st">"equal"</span>,</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"Blues"</span>) <span class="sc">+</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">lwd=</span><span class="fl">0.2</span>,</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="at">text =</span> <span class="st">"ST"</span>, </span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="fl">0.2</span>, </span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Distribution of Conflict Points Across States"</span>,</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside=</span><span class="cn">FALSE</span>,</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the map</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(states_choropleth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/clipboard-1404098727.png" class="img-fluid"></p>
<p>For greater clarity, the top states with the most conflicts exist in <strong>Sagaing</strong>, <strong>Mandalay,</strong> <strong>Magway</strong> and <strong>Yangon</strong> states as indicated in the map above (darkest shade of blue).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>conflict_count <span class="sc">%&gt;%</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_count_ST)) <span class="sc">%&gt;%</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   ST           total_count_ST
   &lt;chr&gt;                 &lt;int&gt;
 1 Sagaing               11128
 2 Magway                 4179
 3 Mandalay               3603
 4 Shan (North)           2938
 5 Kachin                 2776
 6 Yangon                 2608
 7 Rakhine                2277
 8 Tanintharyi            2240
 9 Kayin                  1817
10 Mon                    1677</code></pre>
</div>
</div>
</section>
</section>
<section id="st-order-spatial-point-patterns-analysis" class="level2">
<h2 class="anchored" data-anchor-id="st-order-spatial-point-patterns-analysis"><strong>5. 1st Order Spatial Point Patterns Analysis</strong></h2>
<section id="kernel-density-estimation" class="level3">
<h3 class="anchored" data-anchor-id="kernel-density-estimation">5.1 Kernel Density Estimation</h3>
<section id="working-with-fixed-bandwidth-methods" class="level4">
<h4 class="anchored" data-anchor-id="working-with-fixed-bandwidth-methods">5.1.1 Working with Fixed Bandwidth Methods</h4>
<p>Using the geospatial data sets prepared, I will now perform 1st order spatial point pattern analysis by leveraging <strong>kernel density estimation</strong> <strong>(KDE)</strong> to understand the intensity of conflicts in different regions.</p>
<p>I will be using a variety of <strong>fixed</strong> <strong>bandwidth</strong> methods via <strong><code>density()</code></strong> of the <strong><code>spatstat</code></strong> package, to determine the most optimal method for this analysis. Namely using <strong><code>bw.diggle()</code></strong>, <strong><code>bw.ppl()</code>, <code>bw.CvL()</code></strong> and <strong><code>bw.scott()</code>.</strong></p>
<p><strong>Steps taken to calculate the KDE:</strong></p>
<ol type="1">
<li>Extract the masked ppp object for the current quarter.</li>
<li>Compute the kernel density estimate by setting the <strong><code>signma</code></strong> parameters.</li>
<li>Plot the kernel density estimate using <strong><code>plot()</code></strong> where “Bw” represents the optimal bandwidth</li>
</ol>
<p>For the purposes of identifying the most optimal bandwidth method, I will create a <strong><code>ppp_obj</code></strong> using the <strong>2021 Q1</strong> conflict events first to assist my decision-making.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set Up</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>ppp_obj <span class="ot">=</span> masked_ppp_list<span class="sc">$</span><span class="st">`</span><span class="at">2021 Q1</span><span class="st">`</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>colours <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"midnightblue"</span>, <span class="st">"skyblue"</span>))(<span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="using-bw.diggle" class="level5">
<h5 class="anchored" data-anchor-id="using-bw.diggle"><strong>1) Using bw.diggle()</strong></h5>
<p>The <strong><code>bw.diggle()</code></strong> bandwidth is referred to as Diggle’s cross-validation bandwidth which minimises the mean-squared error (MSE) to balance between under and over-smoothing. I will use the <strong><code>density()</code></strong> function to compute the kernel density of the masked ppp objects and visualise the distribution of conflict event points by using the <strong><code>plot()</code></strong> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bw.diggle()</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>kde_conflict_bw_diggle <span class="ot">&lt;-</span> <span class="fu">density</span>(ppp_obj,</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sigma=</span>bw.diggle,</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>optimal_bw_d <span class="ot">=</span> <span class="fu">floor</span>(<span class="fu">bw.diggle</span>(ppp_obj)[[<span class="dv">1</span>]]<span class="sc">*</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_conflict_bw_diggle, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"BW: diggle"</span>, <span class="st">"("</span>,optimal_bw_d,<span class="st">"m)"</span>), <span class="at">col =</span> colours)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/clipboard-2882188917.png" class="img-fluid"></p>
</section>
<section id="using-bw.ppl" class="level5">
<h5 class="anchored" data-anchor-id="using-bw.ppl"><strong>2) Using bw.ppl()</strong></h5>
<p>The second bandwidth method I attempted using is <strong><code>bw.ppl()</code></strong>, This method chooses the bandwidth that minimises the <strong>likelihood cross-validation score</strong> and improving the <strong>prediction accuracy</strong> of the kernel density estimate.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bw.ppl()</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>kde_conflict_bw_ppl <span class="ot">&lt;-</span> <span class="fu">density</span>(ppp_obj,</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sigma=</span>bw.ppl,</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>optimal_bw_p <span class="ot">=</span> <span class="fu">floor</span>(<span class="fu">bw.ppl</span>(ppp_obj)[[<span class="dv">1</span>]]<span class="sc">*</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_conflict_bw_ppl, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Bw: ppl"</span>, <span class="st">"("</span>,optimal_bw_p,<span class="st">"m)"</span>), <span class="at">col =</span> colours)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/clipboard-2436588955.png" class="img-fluid"></p>
<div class="callout callout-style-default callout-tip callout-titled" title="Reflections">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Reflections
</div>
</div>
<div class="callout-body-container callout-body">
<p>As <code>bw.ppl()</code> tends to choose <strong>smaller bandwidths</strong>, it provide more <strong>localised density estimates</strong> which highlights finer spatial details. As such, we can see <strong>more variability</strong> and <strong>finer</strong> <strong>details</strong> in the density distribution, with more variation between high- and low-density areas.</p>
</div>
</div>
</section>
<section id="using-bw.cvl" class="level5">
<h5 class="anchored" data-anchor-id="using-bw.cvl"><strong>3) Using bw.CvL()</strong></h5>
<p>Thirdly, let’s explore the bandwidth method <strong><code>bw.CvL()</code></strong>, also known as Cronie and Van Lieshout cross-validation<strong>,</strong> designed to provide an <strong>optimal, adaptive bandwidth</strong> for <strong>inhomogeneous point patterns</strong>.<strong>.</strong> Similar to <strong><code>bw.ppl()</code></strong>, it aims to reduce the error measure but also aims to <strong>balance over and under-fitting</strong> based on the spatial structure of the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bw.CvL()</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>kde_conflict_bw_CvL <span class="ot">&lt;-</span> <span class="fu">density</span>(ppp_obj,</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sigma=</span>bw.CvL,</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>optimal_bw_c <span class="ot">=</span> <span class="fu">floor</span>(<span class="fu">bw.CvL</span>(ppp_obj)[[<span class="dv">1</span>]]<span class="sc">*</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_conflict_bw_CvL, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Bw: CvL ("</span>,optimal_bw_c,<span class="st">"m)"</span>), <span class="at">col =</span> colours)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/clipboard-139099524.png" class="img-fluid"></p>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">
<p>The kernel density plot shows that CvL makes a good attempt in <strong>balancing between detail and smoothness</strong>, making it more suitable for capturing the <strong>overall density trends</strong> in spatial data with some <strong>local structures</strong> highlighted.</p>
</div>
</div>
</section>
<section id="using-bw.scott" class="level5">
<h5 class="anchored" data-anchor-id="using-bw.scott"><strong>4) Using bw.scott()</strong></h5>
<p>Lastly, I will explore the <code>bw.scott()</code> bandwidth method. This method returns separate bandwidths for the x- and y-axes which is ideal for our spatial data that contains both x and y components. I will combine these bandwidths into a single value for isotropic kernel density estimation by taking the <strong>taking the geometric mean</strong> as shown in the value returned by <strong><code>sigma_combined</code></strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bw.scott()</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>bw_values <span class="ot">&lt;-</span> <span class="fu">bw.scott</span>(ppp_obj)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>sigma_x <span class="ot">&lt;-</span> bw_values[<span class="dv">1</span>]</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>sigma_y <span class="ot">&lt;-</span> bw_values[<span class="dv">2</span>]</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>sigma_combined <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(sigma_x <span class="sc">*</span> sigma_y)</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>kde_conflict_bw_scott <span class="ot">&lt;-</span> <span class="fu">density</span>(ppp_obj,</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sigma =</span> sigma_combined,</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">edge =</span> <span class="cn">TRUE</span>,</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">kernel =</span> <span class="st">"gaussian"</span>)</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>optimal_bw_s <span class="ot">=</span> <span class="fu">floor</span>(sigma_combined<span class="sc">*</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_conflict_bw_scott, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Bw: scott"</span>, <span class="st">"("</span>,optimal_bw_s,<span class="st">"m)"</span>), <span class="at">col =</span> colours)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/clipboard-479310501.png" class="img-fluid"></p>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">
<p>As shown, the <strong>geometric mean</strong> ensures equal smoothing in both x and y directions, and it largely similar to <strong><code>bw.Cvl()</code></strong>, making it a good choice for a <strong>balanced</strong> and <strong>general overview</strong> of the spatial data distribution.</p>
</div>
</div>
</section>
<section id="selecting-a-bandwidth-method" class="level5">
<h5 class="anchored" data-anchor-id="selecting-a-bandwidth-method"><strong>Selecting a Bandwidth Method</strong></h5>
<p>Based on my research and observations of the charts below, the four methods cater to different types of data depending on how varied the densities are spread across and the granularity of conflict events. Additionally, I notice that <strong><code>bw.ppl()</code></strong> takes a significantly longer time to complete its KDE computations.</p>
<ul>
<li><strong><code>bw.diggle()</code></strong> seems effective for homogeneous data in seeing <strong>general</strong> conflict hotspots.</li>
<li><strong><code>bw.ppl()</code></strong> for non-homogeneous data in analysing specific locations of <strong>localised conflict zones</strong>.</li>
<li><strong><code>bw.CvL()</code></strong> for non-homogeneous data in capturing both <strong>localised conflicts</strong> and the broader <strong>conflict trends</strong>.</li>
<li><strong><code>bw.scott()</code></strong> for a <strong>fast</strong> <strong>overview</strong> and aren’t focusing on small clusters or detailed variations especially when working with large datasets.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Plot all bandwidth methods</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)) </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_conflict_bw_diggle, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"diggle ("</span>,optimal_bw_d,<span class="st">"m)"</span>), <span class="at">col =</span> colours)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_conflict_bw_ppl, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"ppl ("</span>,optimal_bw_p,<span class="st">"m)"</span>), <span class="at">col =</span> colours)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_conflict_bw_CvL, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"CvL ("</span>,optimal_bw_c,<span class="st">"m)"</span>), <span class="at">col =</span> colours)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_conflict_bw_scott, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"scott ("</span>,optimal_bw_s,<span class="st">"m)"</span>), <span class="at">col =</span> colours)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><img src="images/clipboard-3739036667.png" class="img-fluid"></p>
<blockquote class="blockquote">
<p>💡 <strong>Decision: I decided to use</strong> <code>bw.CvL()</code> <strong>for computing the KDE</strong> of the masked ppp objects based on each quarter. As seen above, we get a relatively smooth density estimate that isn’t too detailed like <strong><code>bw.ppl()</code></strong> and has a bandwidth of ~10,000m less than <strong><code>bw.scott()</code></strong> which makes the density not as generalised. This bandwidth method is effective for the <strong>non-homogeneous data</strong> spread of our Myanmar conflict data and it isn’t as computationally heavy as <strong><code>bw.ppl()</code></strong>.</p>
</blockquote>
</section>
<section id="putting-together-our-fixed-kde" class="level5">
<h5 class="anchored" data-anchor-id="putting-together-our-fixed-kde">Putting Together our Fixed KDE</h5>
<p>Now, let us perform the KDE computation for the conflict events across all quarters using <strong><code>bw.CvL()</code></strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate density using bw.CvL()</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)) </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (quarter <span class="cf">in</span> <span class="fu">names</span>(masked_ppp_list)) {</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  ppp_obj <span class="ot">=</span> masked_ppp_list[[quarter]]</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  kde_conflict_bw <span class="ot">&lt;-</span> <span class="fu">density</span>(ppp_obj,</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">sigma=</span>bw.CvL,</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>  optimal_bw <span class="ot">=</span> <span class="fu">floor</span>(<span class="fu">bw.CvL</span>(ppp_obj)[[<span class="dv">1</span>]]<span class="sc">*</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(kde_conflict_bw, <span class="at">main =</span> <span class="fu">paste</span>(quarter, <span class="st">"(Bw:"</span>,optimal_bw,<span class="st">"m)"</span>), <span class="at">col =</span> colours)</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-47-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-47-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">
<p>Using a <strong>fixed KDE</strong> is beneficial for our quarterly analysis here as it ensures <strong>consistency in bandwidth</strong> across different time periods so we can focus on spatial distribution over time.</p>
<p><strong>Density Values Range</strong>: The density values of the output range from <strong>0 to 0.000000002</strong> which can be <strong>too small to comprehend</strong>. After some research, it appears that the default unit of measurement of EPSG:32647 is in <strong>metres</strong>. As such, this causes the density values computed to be in <strong>number</strong> <strong>of points per square metre.</strong></p>
<p><strong>Bandwidth Size</strong>: A bandwidth of around <strong>60,000 to 100,000</strong> is considered relatively large as compared to the bandwidth returned from using <strong><code>bw.diggle()</code></strong> and <strong><code>bw.ppl()</code></strong>. Hence, this results in a <strong>smoother density estimate</strong> with less emphasis on local clusters as indicated in the generalised spatial trends.</p>
</div>
</div>
<p>To make the density values more comprehensible, we will <strong>re-scale</strong> the density values from metres to kilometres using&nbsp;<code>rescale()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>masked_ppp_list_km <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (quarter <span class="cf">in</span> <span class="fu">names</span>(masked_ppp_list)) {</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  ppp_obj <span class="ot">&lt;-</span> masked_ppp_list[[quarter]]</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  ppp_obj_km <span class="ot">&lt;-</span> <span class="fu">rescale</span>(ppp_obj, <span class="dv">1000</span>, <span class="st">"km"</span>)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  masked_ppp_list_km[[quarter]] <span class="ot">&lt;-</span> ppp_obj_km</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we can re-run the&nbsp;<strong><code>density()</code></strong>&nbsp;function to compute the KDE map and round the numbers to their <strong>3rd decimal place.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)) </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (quarter <span class="cf">in</span> <span class="fu">names</span>(masked_ppp_list_km)) {</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  ppp_obj <span class="ot">=</span> masked_ppp_list_km[[quarter]]</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  kde_conflict_bw <span class="ot">&lt;-</span> <span class="fu">density</span>(ppp_obj,</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">sigma=</span>bw.CvL,</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  optimal_bw <span class="ot">=</span> <span class="fu">floor</span>(<span class="fu">bw.CvL</span>(ppp_obj)[[<span class="dv">1</span>]]<span class="sc">*</span><span class="dv">1000</span>)<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(kde_conflict_bw, <span class="at">main =</span> <span class="fu">paste</span>(quarter, <span class="st">"(Bw:"</span>,optimal_bw,<span class="st">"km)"</span>), <span class="at">col =</span> colours)</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/clipboard-2221400801.png" class="img-fluid"></p>
<p><img src="images/clipboard-2997382061.png" class="img-fluid"></p>
<p><img src="images/clipboard-3229467718.png" class="img-fluid"></p>
<blockquote class="blockquote">
<p>💡 Notice the output image looks identical to the earlier version, the only changes are in the data values from <strong>metres</strong> to <strong>kilometres</strong> (refer to the legend).</p>
</blockquote>
</section>
</section>
<section id="working-with-different-kernel-methods" class="level4">
<h4 class="anchored" data-anchor-id="working-with-different-kernel-methods">5.1.2 Working with Different Kernel Methods</h4>
<p>Now, I will experiment with a variety of kernels for the <strong><code>CvL</code></strong> bandwidth method, specifically using the <strong>2021 Q1</strong> conflict data to assist me. I will be using these four kernel methods, namely <strong>gaussian, epanechniko, quartic</strong> and <strong>disc.</strong></p>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">
<p>It is of my observation that the <strong><code>CvL</code></strong> bandwidth will automatically be <strong>defaulted to the Gaussian kernel</strong> like most KDE implementations which causes a warning message ’<strong>Bandwidth selection will be based on Gaussian kernel’.</strong> This means that only after the bandwidth is selected using the Gaussian kernel, the KDE calculation will perform using the non-gaussian kernel specified e.g.&nbsp;<strong><code>quartic</code></strong> / <strong><code>epanechniko</code> / <code>disc</code></strong>. In many cases, this still provides a reasonable estimate.</p>
</div>
</div>
<p>With that said, let us begin with setting up the <strong><code>ppp_obj</code></strong> taken from 2021 Q1 and run the density estimation for each kernel method to identify the most optimal for our dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set Up</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)) </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>ppp_obj <span class="ot">=</span> masked_ppp_list<span class="sc">$</span><span class="st">`</span><span class="at">2021 Q1</span><span class="st">`</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the gaussian kernel</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>kde_conflict_g <span class="ot">&lt;-</span> <span class="fu">density</span>(ppp_obj,</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sigma=</span>bw.CvL,</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_conflict_g, <span class="at">main=</span><span class="st">"Gaussian Kernel"</span>, <span class="at">col =</span> colours)</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the epanechniko kernel</span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>kde_conflict_e <span class="ot">&lt;-</span> <span class="fu">density</span>(ppp_obj,</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sigma=</span>bw.CvL,</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>                           <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>                           <span class="at">kernel=</span><span class="st">"epanechnikov"</span>)</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_conflict_e, <span class="at">main=</span><span class="st">"Epanechnikov Kernel"</span>, <span class="at">col =</span> colours)</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the quartic kernel</span></span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>kde_conflict_g <span class="ot">&lt;-</span> <span class="fu">density</span>(ppp_obj,</span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sigma=</span>bw.CvL,</span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>                           <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a>                           <span class="at">kernel=</span><span class="st">"quartic"</span>)</span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_conflict_g, <span class="at">main=</span><span class="st">"Quartic Kernel"</span>, <span class="at">col =</span> colours)</span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the disc kernel</span></span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a>kde_conflict_e <span class="ot">&lt;-</span> <span class="fu">density</span>(ppp_obj,</span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sigma=</span>bw.CvL,</span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a>                           <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a>                           <span class="at">kernel=</span><span class="st">"disc"</span>)</span>
<span id="cb79-31"><a href="#cb79-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_conflict_e, <span class="at">main=</span><span class="st">"Disc Kernel"</span>, <span class="at">col =</span> colours)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/clipboard-4016342561.png" class="img-fluid"></p>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Gaussian</strong>: provides a <strong>localised</strong> density estimate over the entire spatial extent as compared to <strong><code>epanechnikov</code></strong> and <strong><code>quartic</code></strong>. It is good at <strong>highlighting variance</strong> and <strong>opposing ends of conflict intensities</strong> as shown by the wider range used in the legend.</li>
<li><strong>Epanechnikov</strong>: It is more efficient than the <strong><code>gaussian</code></strong> in terms of variance but produces a slightly rougher surface. It is also more <strong>localised</strong> than the <strong><code>quartic</code></strong> kernel, focusing on areas near each point, with a sharper boundary at the bandwidth limit.</li>
<li><strong>Quartic</strong>: Results in a <strong>good balance</strong> between smoothness and localised influence, smoother than <strong><code>epanechnikov</code></strong> but with similar properties. It appears suitable for moderate smoothing and sharper focus on local patterns.</li>
<li><strong>Disc</strong>: results in the <strong>sharpest density estimate</strong> as compared to the other three kernels as all points within a certain distance are made to have equal influence and zero influence beyond that distance.</li>
</ul>
<p><strong>Decision:</strong> Hence, I will use the <strong><code>quartic</code></strong> kernel method to ensure a relatively smooth density estimate with emphasis on local points over distant ones.</p>
</div>
</div>
<p>As such, I run the density estimate computation using <strong><code>kernel = 'quartic'</code></strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using 'quartic' kernel</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)) </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (quarter <span class="cf">in</span> <span class="fu">names</span>(masked_ppp_list_km)) {</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  ppp_obj <span class="ot">=</span> masked_ppp_list_km[[quarter]]</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  kde_conflict_bw <span class="ot">&lt;-</span> <span class="fu">density</span>(ppp_obj,</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">sigma=</span>bw.CvL,</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">kernel=</span><span class="st">"quartic"</span>)</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>  optimal_bw <span class="ot">=</span> <span class="fu">floor</span>(<span class="fu">bw.CvL</span>(ppp_obj)[[<span class="dv">1</span>]]<span class="sc">*</span><span class="dv">1000</span>)<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(kde_conflict_bw, <span class="at">main =</span> <span class="fu">paste</span>(quarter, <span class="st">"(Bw:"</span>,optimal_bw,<span class="st">"km)"</span>), <span class="at">col =</span> colours)</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/clipboard-2221400801.png" class="img-fluid"></p>
<p><img src="images/clipboard-2997382061.png" class="img-fluid"></p>
<p><img src="images/clipboard-3229467718.png" class="img-fluid"></p>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">
<p>We can see <strong>high densities</strong> of armed conflict in the <strong>central</strong> and <strong>southern</strong> regions of Myanmar but more can be uncovered from conflict data. Let’s proceed to the next section.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>For all subsequent fixed KDE computations, I will assign <strong><code>sigma</code></strong> using the average of the <strong>CvL bandwidth returned</strong> from each quarter<strong>.</strong> Here’s the calculations based on the plots returned:</p>
<p><strong>Average bandwidth size =</strong> <code>61.649 + 64.386 + 74.501 + 114.08 + 103.863 + 103.863 + 95.567 + 56.757 + 57.752 + 66.968 + 49.649 + 48.135 + 48.135 + 60.323) / 14 = 71.831</code></p>
</div>
</div>
<p>Let’s recompute the Fixed KDE based on the newly calculated average bandwidth such that <strong>sigma = 71.831.</strong> I’ll store the quarterly KDE outputs into a list called <strong><code>kde_conflict_bw_list</code></strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using sigma = 71.831</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)) </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add KDE into this list</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>kde_conflict_bw_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (quarter <span class="cf">in</span> <span class="fu">names</span>(masked_ppp_list_km)) {</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>  ppp_obj <span class="ot">=</span> masked_ppp_list_km[[quarter]]</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>  kde_conflict_bw <span class="ot">&lt;-</span> <span class="fu">density</span>(ppp_obj,</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">sigma=</span><span class="fl">71.831</span>,</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">kernel=</span><span class="st">"quartic"</span>)</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>  optimal_bw <span class="ot">=</span> <span class="fu">floor</span>(<span class="fu">bw.CvL</span>(ppp_obj)[[<span class="dv">1</span>]]<span class="sc">*</span><span class="dv">1000</span>)<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>  kde_conflict_bw_list[[quarter]] <span class="ot">&lt;-</span> kde_conflict_bw</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(kde_conflict_bw, <span class="at">main =</span> <span class="fu">paste</span>(quarter, <span class="st">"(Bw:"</span>,optimal_bw,<span class="st">"km)"</span>), <span class="at">col =</span> colours)</span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-52-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-52-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="working-with-adaptive-kde" class="level4">
<h4 class="anchored" data-anchor-id="working-with-adaptive-kde">5.1.3 Working with Adaptive KDE</h4>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clipboard-3061655849.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="500"></p>
</figure>
</div>
<p>As seen above, <strong>fixed</strong> bandwidths tend to <strong>oversmooth</strong> the mode of the distribution. On the contrary, the <strong>adaptive</strong> kernel estimate has the ability to <strong>reduce variability</strong> of estimates in areas with <strong>low density</strong> and <strong>increases</strong> it in areas with <strong>higher density</strong> (The Stata Journal, 2003).</p>
<p>Once again, let us use the <strong>2021 Q1</strong> conflict data to illustrate the difference in outputs of all three adaptive methods.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"></ul>
<div class="tab-content">

</div>
</div>
<p>We can also compare the performance of each method based on the <strong>top 4</strong> highest density <strong>states</strong> as highlighted earlier.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"></ul>
<div class="tab-content">

</div>
</div>
<p><strong>Comparing the three Adaptive KDE Types</strong></p>
<p>From the outputs above, it appears that there is no major differences between the distribution of KDE values returned across the three methods, where there is high concentration of points in a specific area. Hence, we will choose to go with&nbsp;<code>Adapative Kernel</code>&nbsp;method.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>),<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(vd_adaptive_kde,<span class="at">main =</span> <span class="st">"Voronoi-Dirichlet Adaptive"</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(adaptive_kde,<span class="at">main =</span> <span class="st">"Adaptive Kernel"</span>)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(nn_kde,<span class="at">main =</span> <span class="st">"Nearest-Neighbour Adaptive"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/clipboard-3272856398.png" class="img-fluid"></p>
<p><strong>Let’s compare the results of my two selected fixed and adaptive KDEs (E.g. Magway District)</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>))</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>district_boundary <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(<span class="fu">st_as_sfc</span>(boundary_magway))</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>ppp_obj <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(<span class="fu">st_geometry</span>(conflict_magway), <span class="at">W =</span> district_boundary)</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>ppp_obj <span class="ot">&lt;-</span> <span class="fu">rescale</span>(ppp_obj, <span class="dv">1000</span>, <span class="st">"km"</span>)</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>kde_fixed <span class="ot">&lt;-</span> <span class="fu">density</span>(ppp_obj, <span class="at">sigma=</span>bw.CvL, <span class="at">edge=</span><span class="cn">TRUE</span>, <span class="at">kernel=</span><span class="st">"quartic"</span>)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_fixed, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Fixed KDE (CvL | quartic)"</span>), <span class="at">col =</span> colours)</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>kde_adaptive <span class="ot">&lt;-</span> <span class="fu">adaptive.density</span>(ppp_obj, <span class="at">method=</span><span class="st">"kernel"</span>)</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_adaptive, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Adaptive KDE (Kernel)"</span>), <span class="at">col=</span>colours)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/clipboard-263685601.png" class="img-fluid"></p>
<blockquote class="blockquote">
<p>We can observe how <strong>adaptive kernels</strong> provides a <strong>more detailed</strong> picture of conflict spatial distribution but since it’s largely localised, conflict spots require more effort in identifying and can be <strong>computationally heavy</strong> for this exercise.</p>
<p>Additionally, <strong>varying bandwidth</strong> makes comparisons across <strong>regions</strong> or <strong>time</strong> <strong>periods</strong> (like quarters) <strong>more difficult</strong> because the scale of smoothing is not constant across space and time.</p>
</blockquote>
</section>
<section id="converting-gridded-kde-output-into-raster" class="level4">
<h4 class="anchored" data-anchor-id="converting-gridded-kde-output-into-raster">5.1.5 <strong>Converting Gridded KDE Output into Raster</strong></h4>
<p>Next, we need to convert the KDE output to KDE raster layers before it can be viewed using <strong><code>tmap</code></strong>.</p>
<p><strong>Step 1) Converting KDE to Spatial Grid Data Frame</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'grid'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:spatstat.geom':

    as.mask</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>plot_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (quarter <span class="cf">in</span> <span class="fu">names</span>(kde_conflict_bw_list)) {</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  ppp_obj <span class="ot">&lt;-</span> kde_conflict_bw_list[[quarter]]</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  gridded_ppp_obj <span class="ot">&lt;-</span> <span class="fu">as</span>(ppp_obj, <span class="st">"SpatialGridDataFrame"</span>)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  plot_list[[quarter]] <span class="ot">&lt;-</span> <span class="fu">spplot</span>(gridded_ppp_obj, <span class="at">main =</span> <span class="fu">paste</span>(quarter), <span class="at">col.regions =</span> colours)</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gridExtra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>plot_list_subset1 <span class="ot">&lt;-</span> plot_list[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>plot_list_subset2 <span class="ot">&lt;-</span> plot_list[<span class="dv">7</span><span class="sc">:</span><span class="dv">12</span>]</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>plot_list_subset3 <span class="ot">&lt;-</span> plot_list[<span class="dv">13</span><span class="sc">:</span><span class="dv">14</span>]</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.newpage</span>()</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> plot_list_subset1, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.newpage</span>() </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> plot_list_subset2, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-61-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.newpage</span>()</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> plot_list_subset3, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-61-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Step 2) Rasterisation of Grid Outputs &amp; Assigning Projection Systems</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>gridded_ppp_obj_raster_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (quarter <span class="cf">in</span> <span class="fu">names</span>(kde_conflict_bw_list)) {</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  gridded_ppp_obj <span class="ot">=</span> kde_conflict_bw_list[[quarter]]</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  gridded_ppp_obj_raster <span class="ot">&lt;-</span> <span class="fu">raster</span>(gridded_ppp_obj)</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">projection</span>(gridded_ppp_obj_raster) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">"+init=EPSG:32647"</span>)</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  gridded_ppp_obj_raster_list[[quarter]] <span class="ot">&lt;-</span> gridded_ppp_obj_raster</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect for 2024 Q2</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>gridded_ppp_obj_raster_list<span class="sc">$</span><span class="st">`</span><span class="at">2024 Q2</span><span class="st">`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class      : RasterLayer 
dimensions : 128, 128, 16384  (nrow, ncol, ncell)
resolution : 7.302001, 16.30032  (x, y)
extent     : -210.0086, 724.6476, 1072.026, 3158.467  (xmin, xmax, ymin, ymax)
crs        : +proj=utm +zone=47 +datum=WGS84 +units=m +no_defs 
source     : memory
names      : layer 
values     : 7.061861e-06, 0.01847887  (min, max)</code></pre>
</div>
</div>
<p><strong>Step 3) Plot Maps</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>tmap mode set to plotting</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>plots_by_quarter <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (quarter <span class="cf">in</span> <span class="fu">names</span>(gridded_ppp_obj_raster_list)){</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  gridded_ppp_obj_raster <span class="ot">=</span> gridded_ppp_obj_raster_list[[quarter]]</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  raster_plot <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(gridded_ppp_obj_raster) <span class="sc">+</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_raster</span>(<span class="st">"layer"</span>, <span class="at">title=</span><span class="st">"Density"</span>, <span class="at">palette=</span><span class="st">"Blues"</span>) <span class="sc">+</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tm_layout</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"left"</span>,<span class="st">"bottom"</span>),<span class="at">frame=</span><span class="cn">FALSE</span>, <span class="at">main.title =</span> quarter,</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size=</span><span class="dv">1</span>, <span class="at">main.title.position =</span> <span class="st">"center"</span>, <span class="at">legend.text.size =</span> <span class="fl">0.5</span>,<span class="at">legend.title.size =</span> <span class="fl">0.7</span>) </span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>  plots_by_quarter[[quarter]] <span class="ot">&lt;-</span> raster_plot</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(plots_by_quarter[<span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>], <span class="at">ncol=</span><span class="dv">5</span>, <span class="at">nrow=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Legend labels were too wide. The labels have been resized to 0.3, 0.3, 0.3, 0.3. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Legend labels were too wide. The labels have been resized to 0.3, 0.3, 0.3, 0.3, 0.3. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.
Legend labels were too wide. The labels have been resized to 0.3, 0.3, 0.3, 0.3, 0.3. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.
Legend labels were too wide. The labels have been resized to 0.3, 0.3, 0.3, 0.3, 0.3. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Legend labels were too wide. The labels have been resized to 0.3, 0.3, 0.3, 0.3. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Legend labels were too wide. The labels have been resized to 0.3, 0.3, 0.3, 0.3, 0.3. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.
Legend labels were too wide. The labels have been resized to 0.3, 0.3, 0.3, 0.3, 0.3. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.
Legend labels were too wide. The labels have been resized to 0.3, 0.3, 0.3, 0.3, 0.3. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Legend labels were too wide. The labels have been resized to 0.3, 0.3, 0.3, 0.3, 0.3, 0.3. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Legend labels were too wide. The labels have been resized to 0.3, 0.3, 0.3, 0.3, 0.3. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Legend labels were too wide. The labels have been resized to 0.3, 0.3, 0.3, 0.3, 0.3, 0.3. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Legend labels were too wide. The labels have been resized to 0.3, 0.3, 0.3, 0.3. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.
Legend labels were too wide. The labels have been resized to 0.3, 0.3, 0.3, 0.3. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Legend labels were too wide. The labels have been resized to 0.3, 0.3, 0.3, 0.3, 0.3, 0.3. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">
<p>Plotting raster grid versions of KDE outputs uses discrete colour ranges which does a good job in highlighting gradual changes in conflict events across an area. Since 2021 Q2, more conflicts are seen in Southern parts of Myanmar. The density range differs for each quarter but we can see an increase in no. of armed conflicts per kilometre from 2021 Q1 to 2022 Q2, which stagnates in density and increases again in 2023 Q4.</p>
</div>
</div>
</section>
</section>
<section id="nearest-neighbour-analysis" class="level3">
<h3 class="anchored" data-anchor-id="nearest-neighbour-analysis">5.2 Nearest Neighbour Analysis</h3>
<p>Our current analyses does not reveal patterns of clustering or dispersion, to which Michael J. Crawley proposes to employ <strong>Clark-Evans</strong> <strong>test</strong> spatial randomness for its simplicity and applicability for <strong>first-order spatial analysis</strong>, which means checking for overall spatial randomness based on nearest-neighbor distances. (Crawley M. J. , 2007)</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clipboard-1436160892.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="386"></p>
</figure>
</div>
<p><strong>Clark-Evans Test</strong></p>
<p>The test checks whether the observed point pattern of armed conflicts in Myanmar shows <strong>clustering</strong> (points are closer than expected under randomness), <strong>dispersion</strong> (points are more spread out), or <strong>randomness</strong>.</p>
<p><strong>The test hypotheses are:</strong></p>
<ul>
<li><strong>Ho</strong> = The distribution of armed conflicts in Myanmar are randomly distributed.</li>
<li><strong>H1</strong>= The distribution of armed conflicts in Myanmar are not randomly distributed.</li>
<li>The <strong>95%</strong> confident interval will be used.</li>
</ul>
<p>We will conduct the test using <a href="https://www.rdocumentation.org/packages/spatstat/versions/1.63-3/topics/clarkevans.test">clarkevans.test()</a> of <strong>statspat</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (quarter <span class="cf">in</span> <span class="fu">names</span>(masked_ppp_list_km)) {</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  ppp_obj <span class="ot">=</span> masked_ppp_list_km[[quarter]]</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(quarter)</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">clarkevans.test</span>(ppp_obj,</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">correction=</span><span class="st">"none"</span>,</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">clipregion=</span><span class="st">"boundary_sf"</span>,</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">alternative=</span><span class="fu">c</span>(<span class="st">"clustered"</span>),</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nsim=</span><span class="dv">99</span>))</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2024 Q2"

    Clark-Evans test
    No edge correction
    Z-test

data:  ppp_obj
R = 0.26663, p-value &lt; 2.2e-16
alternative hypothesis: clustered (R &lt; 1)

[1] "2024 Q1"

    Clark-Evans test
    No edge correction
    Z-test

data:  ppp_obj
R = 0.23563, p-value &lt; 2.2e-16
alternative hypothesis: clustered (R &lt; 1)

[1] "2023 Q4"

    Clark-Evans test
    No edge correction
    Z-test

data:  ppp_obj
R = 0.21795, p-value &lt; 2.2e-16
alternative hypothesis: clustered (R &lt; 1)

[1] "2023 Q3"

    Clark-Evans test
    No edge correction
    Z-test

data:  ppp_obj
R = 0.22002, p-value &lt; 2.2e-16
alternative hypothesis: clustered (R &lt; 1)

[1] "2023 Q2"

    Clark-Evans test
    No edge correction
    Z-test

data:  ppp_obj
R = 0.24485, p-value &lt; 2.2e-16
alternative hypothesis: clustered (R &lt; 1)

[1] "2023 Q1"

    Clark-Evans test
    No edge correction
    Z-test

data:  ppp_obj
R = 0.24365, p-value &lt; 2.2e-16
alternative hypothesis: clustered (R &lt; 1)

[1] "2022 Q4"

    Clark-Evans test
    No edge correction
    Z-test

data:  ppp_obj
R = 0.22139, p-value &lt; 2.2e-16
alternative hypothesis: clustered (R &lt; 1)

[1] "2022 Q3"

    Clark-Evans test
    No edge correction
    Z-test

data:  ppp_obj
R = 0.23974, p-value &lt; 2.2e-16
alternative hypothesis: clustered (R &lt; 1)

[1] "2022 Q2"

    Clark-Evans test
    No edge correction
    Z-test

data:  ppp_obj
R = 0.22989, p-value &lt; 2.2e-16
alternative hypothesis: clustered (R &lt; 1)

[1] "2022 Q1"

    Clark-Evans test
    No edge correction
    Z-test

data:  ppp_obj
R = 0.21976, p-value &lt; 2.2e-16
alternative hypothesis: clustered (R &lt; 1)

[1] "2021 Q4"

    Clark-Evans test
    No edge correction
    Z-test

data:  ppp_obj
R = 0.21341, p-value &lt; 2.2e-16
alternative hypothesis: clustered (R &lt; 1)

[1] "2021 Q3"

    Clark-Evans test
    No edge correction
    Z-test

data:  ppp_obj
R = 0.21808, p-value &lt; 2.2e-16
alternative hypothesis: clustered (R &lt; 1)

[1] "2021 Q2"

    Clark-Evans test
    No edge correction
    Z-test

data:  ppp_obj
R = 0.17458, p-value &lt; 2.2e-16
alternative hypothesis: clustered (R &lt; 1)

[1] "2021 Q1"

    Clark-Evans test
    No edge correction
    Z-test

data:  ppp_obj
R = 0.24696, p-value &lt; 2.2e-16
alternative hypothesis: clustered (R &lt; 1)</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">
<p>For a 95% confidence level, If the <strong>p-value &lt; 0.05</strong>, I will <strong>reject</strong> <strong>the null hypothesis</strong> of complete spatial randomness and <strong>check if data is uniform (R &gt; 1)</strong> or <strong>clustered (R &lt; 1).</strong></p>
<p>With that said, all tests conducted across each quarter <strong>rejects the null hypothesis</strong> as <strong>p &lt; 0.05</strong> and spatial points are found to be <strong>clustered</strong> since <strong>R &lt; 1</strong>.</p>
</div>
</div>
</section>
<section id="further-data-exploration" class="level3">
<h3 class="anchored" data-anchor-id="further-data-exploration">5.3 Further Data Exploration</h3>
<p>By using the fixed KDE with CvL bandwidth and quartic kernel, let’s see what insights can we glean from the density of conflicts in Myanmar.</p>
<section id="kde-by-event-type" class="level4">
<h4 class="anchored" data-anchor-id="kde-by-event-type">5.3.1 KDE by <em>Event Type</em></h4>
<p>First, let’s identify the unique event types in this dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check unique events</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(conflict_data_sf<span class="sc">$</span>event_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Battles"                    "Strategic developments"    
[3] "Violence against civilians" "Explosions/Remote violence"</code></pre>
</div>
</div>
<p>Now, let us analyse the kernel density estimate of each unique event type found in <strong><code>conflict_data_sf</code></strong> to identify hot and cold spots across Myanmar.</p>
<div class="cell">
<details class="code-fold">
<summary>Plot the KDE based on Event Type</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set Up</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)) </span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>conflict_data_sf <span class="sc">%&gt;%</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(event_type) <span class="sc">%&gt;%</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_split</span>() <span class="ot">-&gt;</span> conflict_by_event_type</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the sf object to owin</span></span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>district_boundary <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(<span class="fu">st_as_sfc</span>(boundary_sf))</span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>kde_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(conflict_by_event_type), <span class="cf">function</span>(i) {</span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> conflict_by_event_type[[i]]</span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a>  event_type <span class="ot">&lt;-</span> <span class="fu">unique</span>(data<span class="sc">$</span>event_type)</span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a>  ppp_obj <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(<span class="fu">st_geometry</span>(data), <span class="at">W =</span> district_boundary)</span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a>  ppp_obj <span class="ot">&lt;-</span> <span class="fu">rescale</span>(ppp_obj, <span class="dv">1000</span>, <span class="st">"km"</span>)</span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a>  kde <span class="ot">&lt;-</span> <span class="fu">density</span>(ppp_obj,</span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sigma=</span><span class="fl">71.831</span>,</span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">kernel=</span><span class="st">"quartic"</span>)</span>
<span id="cb111-20"><a href="#cb111-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(kde, <span class="at">main =</span> <span class="fu">paste</span>(event_type), <span class="at">col=</span>colours)</span>
<span id="cb111-21"><a href="#cb111-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(kde)</span>
<span id="cb111-22"><a href="#cb111-22" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 3 points were rejected as lying outside the specified window</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: data contain duplicated points
Warning: data contain duplicated points</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 1 point was rejected as lying outside the specified window</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: data contain duplicated points</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 3 points were rejected as lying outside the specified window</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: data contain duplicated points</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><img src="images/clipboard-80379057.png" class="img-fluid"></p>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">
<p>We can almost see an equal spread of all four event types, with <strong>battles</strong> being more dominantly found in <strong>Central</strong> <strong>Myanmar</strong>, followed by strategic developments and violence against citizens.</p>
</div>
</div>
</section>
<section id="kde-across-top-4-states-with-most-conflicts" class="level4">
<h4 class="anchored" data-anchor-id="kde-across-top-4-states-with-most-conflicts">5.3.2 KDE Across Top 4 States With Most Conflicts</h4>
<p>Previously, we identified the <strong>top 4</strong> <strong>states</strong> with the highest proportions of conflicts as Sagaing, Mandalay, Magway and Yangon. We can delve deeper into each state by <strong>analysing the intensity of conflicts</strong> across these states using <strong><code>density()</code></strong>.</p>
<div class="cell">
<details class="code-fold">
<summary>Plot the KDE of Top 4 States</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set Up</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>))</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Sagaing</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>district_boundary <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(<span class="fu">st_as_sfc</span>(boundary_sagaing))</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>ppp_obj <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(<span class="fu">st_geometry</span>(conflict_sagaing), <span class="at">W =</span> district_boundary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: data contain duplicated points</code></pre>
</div>
<details class="code-fold">
<summary>Plot the KDE of Top 4 States</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>ppp_obj_sagaing <span class="ot">&lt;-</span> <span class="fu">rescale</span>(ppp_obj, <span class="dv">1000</span>, <span class="st">"km"</span>)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>kde <span class="ot">&lt;-</span> <span class="fu">density</span>(ppp_obj_sagaing,</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">sigma=</span><span class="fl">71.831</span>,</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">kernel=</span><span class="st">"quartic"</span>)</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Sagaing"</span>), <span class="at">col=</span>colours)</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Mandalay</span></span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>district_boundary <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(<span class="fu">st_as_sfc</span>(boundary_mandalay))</span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>ppp_obj <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(<span class="fu">st_geometry</span>(conflict_mandalay), <span class="at">W =</span> district_boundary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: data contain duplicated points</code></pre>
</div>
<details class="code-fold">
<summary>Plot the KDE of Top 4 States</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>ppp_obj_mandalay <span class="ot">&lt;-</span> <span class="fu">rescale</span>(ppp_obj, <span class="dv">1000</span>, <span class="st">"km"</span>)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>kde <span class="ot">&lt;-</span> <span class="fu">density</span>(ppp_obj_mandalay,</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">sigma=</span><span class="fl">71.831</span>,</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">kernel=</span><span class="st">"quartic"</span>)</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Mandalay"</span>), <span class="at">col=</span>colours)</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Magway</span></span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>district_boundary <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(<span class="fu">st_as_sfc</span>(boundary_magway))</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>ppp_obj <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(<span class="fu">st_geometry</span>(conflict_magway), <span class="at">W =</span> district_boundary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: data contain duplicated points</code></pre>
</div>
<details class="code-fold">
<summary>Plot the KDE of Top 4 States</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>ppp_obj_magway <span class="ot">&lt;-</span> <span class="fu">rescale</span>(ppp_obj, <span class="dv">1000</span>, <span class="st">"km"</span>)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>kde <span class="ot">&lt;-</span> <span class="fu">density</span>(ppp_obj_magway,</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">sigma=</span><span class="fl">71.831</span>,</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">kernel=</span><span class="st">"quartic"</span>)</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Magway"</span>), <span class="at">col=</span>colours)</span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Yangon</span></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>district_boundary <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(<span class="fu">st_as_sfc</span>(boundary_yangon))</span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>ppp_obj <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(<span class="fu">st_geometry</span>(conflict_yangon), <span class="at">W =</span> district_boundary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: data contain duplicated points</code></pre>
</div>
<details class="code-fold">
<summary>Plot the KDE of Top 4 States</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>ppp_obj_yangon <span class="ot">&lt;-</span> <span class="fu">rescale</span>(ppp_obj, <span class="dv">1000</span>, <span class="st">"km"</span>)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>kde <span class="ot">&lt;-</span> <span class="fu">density</span>(ppp_obj_yangon,</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">sigma=</span><span class="fl">71.831</span>,</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">kernel=</span><span class="st">"quartic"</span>)</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Yangon"</span>), <span class="at">col=</span>colours)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">
<p>It’s interesting that armed conflict isn’t evenly distributed across the states though it does seem that <strong>armed conflict</strong> has <strong>inflicted the entire state of Yangon.</strong> Nonetheless, it is worth noting that Yangon is <strong>relatively smaller in size</strong> than the other three states and that will <strong>increase</strong> the density of conflict <strong>quite significantly.</strong></p>
</div>
</div>
</section>
<section id="kde-of-top-4-states-by-event-type" class="level4">
<h4 class="anchored" data-anchor-id="kde-of-top-4-states-by-event-type">5.3.3 KDE of Top 4 States by <em>Event Type</em></h4>
<p>It’ll also be interesting to breakdown each top 4 state <strong>by the event type</strong> category as shown.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"></ul>
<div class="tab-content">

</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">
<p>The kernel density of <strong>violence against civillians</strong> is generally found to be the <strong>lowest</strong> amongst all conflict events. Additionally, all types of armed conflicts tend to <strong>occur repeatedly</strong> in the <strong>same parts of each state.</strong> E.g. conflicts regarding strategic development tend to happen in Southern part of the Sagaing state, just as it is for explosions/remote violence.</p>
</div>
</div>
</section>
</section>
</section>
<section id="nd-order-spatial-point-patterns-analysis" class="level2">
<h2 class="anchored" data-anchor-id="nd-order-spatial-point-patterns-analysis">6. 2nd Order Spatial Point Patterns Analysis</h2>
<p>Unlike 1st-order analysis, which studies the intensity of points (e.g., density), let’s also leverage 2nd-order analysis to examine how points are distributed relative to each other, which can offer deeper insights into the spatial interaction between events.</p>
<p>I will use the K-function and L-function is to understand the spatial relationships between events, particularly focusing on whether the points exhibit clustering, uniformity, or randomness.</p>
<section id="using-k-function-estimation" class="level3">
<h3 class="anchored" data-anchor-id="using-k-function-estimation">6.1 Using K-Function Estimation</h3>
<p><strong>K-function</strong> helps detect spatial patterns by comparing the observed distribution of points against a random pattern at different distances.</p>
<section id="yinmarbin-district" class="level4">
<h4 class="anchored" data-anchor-id="yinmarbin-district"><strong>6.1.1 Yinmarbin District</strong></h4>
<p><strong>1) Computing K-Function Estimation</strong></p>
<p>For Yinmarbin district, let’s compute K-function estimates by using <strong><code>Kest()</code></strong> of the <strong>spatstat</strong> package.</p>
<div class="cell">
<details class="code-fold">
<summary>Prepare Dataset for Yinmarbin District</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>conflict_yinmarbin <span class="ot">=</span> <span class="fu">filter</span>(conflict_data_sf, DT <span class="sc">==</span> <span class="st">"Yinmarbin"</span>)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>boundary_yinmarbin <span class="ot">&lt;-</span> <span class="fu">filter</span>(boundary_sf, DT <span class="sc">==</span> <span class="st">"Yinmarbin"</span>)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>yinmarbin_owin <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(boundary_yinmarbin)</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a combined ppp and owin object</span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>ppp_obj <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(conflict_yinmarbin<span class="sc">$</span>geometry)</span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>masked_ppp <span class="ot">&lt;-</span> ppp_obj[yinmarbin_owin]</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>yinmarbin_ppp_owin <span class="ot">&lt;-</span> <span class="fu">rescale</span>(masked_ppp, <span class="dv">1000</span>, <span class="st">"km"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We are now ready to plot the K-function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>K_ck <span class="ot">=</span> <span class="fu">Kest</span>(yinmarbin_ppp_owin, <span class="at">correction =</span> <span class="st">"Ripley"</span>)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(K_ck, . <span class="sc">-</span>r <span class="sc">~</span> r, <span class="at">ylab=</span> <span class="st">"K(d)-r"</span>, <span class="at">xlab =</span> <span class="st">"d(m)"</span>,</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Yinmarbin District (K-Function)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>How to interpret the plot:</strong></p>
<ul>
<li><strong>K-iso</strong> represents the observed or estimated K-function value calculated from the actual data</li>
<li><strong>K-pois</strong> is the theoretical K-function that represents the expected K-function</li>
</ul>
<p><strong>With that said…</strong></p>
<p>We can observe how the <strong>observed line (K-iso)</strong> is constantly above the <strong>theoretical line</strong> from <strong>2021 Q2 to 2024 Q2</strong>. This confirms that conflict points in <strong>Yinmarbin</strong> are <strong>highly clustered</strong>. In fact, it is more clustered together than expected by the null hypothesis.</p>
<p>However, we do not have any conflict points in <strong>2021 Q1</strong></p>
<p><strong>Note:</strong> Since I had used the default <strong><code>edge = TRUE</code></strong> settings, edge correction will account for missing neighbours outside the boundary which helps maintain an accurate estimate of the K-function.</p>
</div>
</div>
<p><strong>2) Performing Complete Spatial Randomness Test</strong></p>
<p>To confirm the observed spatial patterns above, a hypothesis test (i.e.&nbsp;Monta Carlo simulation test) will be conducted. The hypothesis and test are as follows:</p>
<ul>
<li><strong>Ho</strong> = The distribution of conflict events in Myanmar are randomly distributed.</li>
<li><strong>H1</strong>= The distribution of conflict events in Myanmar are not randomly distributed.</li>
<li>The null hypothesis will be rejected if <strong>p-value is smaller</strong> than <strong>alpha value of 0.001</strong>.</li>
</ul>
<p>By using <strong><code>envelop()</code></strong>, we can get a more robust interpretation by comparing the observed K-function against a simulation envelope of K-functions generated under the null hypothesis.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>To achieve a <strong>95% confidence envelope</strong> in a K-function test with <strong>Complete Spatial Randomness,</strong> I will need to exclude the upper 2.5% and lower 2.5% of the simulated K-functions., i.e.&nbsp;I will need to generate <strong>at least</strong> <strong>40 simulations</strong> where <strong><code>nsim = 39</code></strong>.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Monte Carlo test with K-function</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>K_ck.csr <span class="ot">&lt;-</span> <span class="fu">envelope</span>(yinmarbin_ppp_owin, Kest, </span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nsim =</span> <span class="dv">39</span>, <span class="at">rank =</span> <span class="dv">1</span>, <span class="at">glocal=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 39 simulations of CSR  ...
1, 2, 
[29:43 remaining, estimate finish 2024-09-16 19:42:45]
3, 
[27:46 remaining, estimate finish 2024-09-16 19:41:32]
4, 
[27:03 remaining, estimate finish 2024-09-16 19:41:35]
5, 
[25:53 remaining, estimate finish 2024-09-16 19:41:09]
6, 
[25:05 remaining, estimate finish 2024-09-16 19:41:06]
7, 
[24:32 remaining, estimate finish 2024-09-16 19:41:21]
8, 
[24:01 remaining, estimate finish 2024-09-16 19:41:39]
9, 
[23:11 remaining, estimate finish 2024-09-16 19:41:36]
10, 
[22:19 remaining, estimate finish 2024-09-16 19:41:27]
11, 
[21:31 remaining, estimate finish 2024-09-16 19:41:25]
12, 
[20:53 remaining, estimate finish 2024-09-16 19:41:37]
13, 
[20:04 remaining, estimate finish 2024-09-16 19:41:32]
14, 
[19:22 remaining, estimate finish 2024-09-16 19:41:40]
15, 
[18:34 remaining, estimate finish 2024-09-16 19:41:37]
16, 
[17:49 remaining, estimate finish 2024-09-16 19:41:40]
17, 
[17:00 remaining, estimate finish 2024-09-16 19:41:35]
18, 
[16:19 remaining, estimate finish 2024-09-16 19:41:44]
19, 
[15:32 remaining, estimate finish 2024-09-16 19:41:44]
20, 
[14:43 remaining, estimate finish 2024-09-16 19:41:39]
21, 
[13:57 remaining, estimate finish 2024-09-16 19:41:40]
22, 
[13:10 remaining, estimate finish 2024-09-16 19:41:39]
23, 
[12:22 remaining, estimate finish 2024-09-16 19:41:36]
24, 
[11:35 remaining, estimate finish 2024-09-16 19:41:34]
25, 
[10:49 remaining, estimate finish 2024-09-16 19:41:35]
26, 
[10:03 remaining, estimate finish 2024-09-16 19:41:37]
27,  [9:17 remaining] 28,  [8:31 remaining] 29,  [7:44 remaining] 30,  [6:57 remaining] 31,  [6:15 remaining] 32,  [5:32 remaining] 33,  [4:46 remaining] 34,  [3:59 remaining] 35,  [3:12 remaining] 36,  [2:26 remaining] 37,  [1:39 remaining] 38,  [49 sec remaining] 
39.

Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(K_ck.csr, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Yinmarbin District (CSR)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
</section>
<section id="shwebo-district" class="level4">
<h4 class="anchored" data-anchor-id="shwebo-district"><strong>6.1.2 Shwebo District</strong></h4>
<p><strong>1) Computing K-Function Estimation</strong></p>
<p>For Shwebo district, let’s compute K-function estimates by using <strong><code>Kest()</code></strong> of the <strong>spatstat</strong> package.</p>
<div class="cell">
<details class="code-fold">
<summary>Prepare Dataset for Shwebo District</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>conflict_shwebo <span class="ot">=</span> <span class="fu">filter</span>(conflict_data_sf, DT <span class="sc">==</span> <span class="st">"Shwebo"</span>)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>boundary_shwebo <span class="ot">&lt;-</span> <span class="fu">filter</span>(boundary_sf, DT <span class="sc">==</span> <span class="st">"Shwebo"</span>)</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>shwebo_owin <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(boundary_shwebo)</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a combined ppp and owin object</span></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>ppp_obj <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(conflict_shwebo<span class="sc">$</span>geometry)</span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>masked_ppp <span class="ot">&lt;-</span> ppp_obj[shwebo_owin]</span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>shwebo_ppp_owin <span class="ot">&lt;-</span> <span class="fu">rescale</span>(masked_ppp, <span class="dv">1000</span>, <span class="st">"km"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We are now ready to plot the K-function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>K_ck <span class="ot">=</span> <span class="fu">Kest</span>(shwebo_ppp_owin, <span class="at">correction =</span> <span class="st">"Ripley"</span>)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(K_ck, . <span class="sc">-</span>r <span class="sc">~</span> r, <span class="at">ylab=</span> <span class="st">"K(d)-r"</span>, <span class="at">xlab =</span> <span class="st">"d(m)"</span>,</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Shwebo District (K-Function)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<p><strong>2) Performing Complete Spatial Randomness Test</strong></p>
<p>To confirm the observed spatial patterns above, a hypothesis test (i.e.&nbsp;Monta Carlo simulation test) will be conducted. The hypothesis and test are as follows:</p>
<ul>
<li><strong>Ho</strong> = The distribution of conflict events in Myanmar are randomly distributed.</li>
<li><strong>H1</strong>= The distribution of conflict events in Myanmar are not randomly distributed.</li>
<li>The null hypothesis will be rejected if <strong>p-value is smaller</strong> than <strong>alpha value of 0.001</strong>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Monte Carlo test with K-function</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>K_ck.csr <span class="ot">&lt;-</span> <span class="fu">envelope</span>(shwebo_ppp_owin, Kest, </span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nsim =</span> <span class="dv">39</span>, <span class="at">rank =</span> <span class="dv">1</span>, <span class="at">glocal=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 39 simulations of CSR  ...
1, 2, 
[2:02:05 remaining, estimate finish 2024-09-16 22:02:05]
3, 
[2:05:33 remaining, estimate finish 2024-09-16 22:09:13]
4, 
[2:01:07 remaining, estimate finish 2024-09-16 22:08:12]
5, 
[1:56:04 remaining, estimate finish 2024-09-16 22:06:26]
6, 
[1:55:29 remaining, estimate finish 2024-09-16 22:09:41]
7, 
[1:59:33 remaining, estimate finish 2024-09-16 22:18:39]
8, 
[1:58:01 remaining, estimate finish 2024-09-16 22:21:21]
9, 
[1:52:50 remaining, estimate finish 2024-09-16 22:19:37]
10, 
[1:51:44 remaining, estimate finish 2024-09-16 22:23:06]
11, 
[1:48:46 remaining, estimate finish 2024-09-16 22:24:19]
12, 
[1:47:49 remaining, estimate finish 2024-09-16 22:28:27]
13, 
[1:43:52 remaining, estimate finish 2024-09-16 22:28:30]
14, 
[1:38:23 remaining, estimate finish 2024-09-16 22:26:15]
15, 
[1:33:19 remaining, estimate finish 2024-09-16 22:24:27]
16, 
[1:28:26 remaining, estimate finish 2024-09-16 22:22:49]
17, 
[1:23:52 remaining, estimate finish 2024-09-16 22:21:33]
18, 
[1:19:50 remaining, estimate finish 2024-09-16 22:21:09]
19, 
[1:15:26 remaining, estimate finish 2024-09-16 22:20:01]
20, 
[1:11:13 remaining, estimate finish 2024-09-16 22:19:08]
21, 
[1:07:06 remaining, estimate finish 2024-09-16 22:18:22]
22, 
[1:03:09 remaining, estimate finish 2024-09-16 22:17:52]
23, 
[59:12 remaining, estimate finish 2024-09-16 22:17:18]
24, 
[55:18 remaining, estimate finish 2024-09-16 22:16:47]
25, 
[51:20 remaining, estimate finish 2024-09-16 22:16:03]
26, 
[47:30 remaining, estimate finish 2024-09-16 22:15:33]
27, 
[44:13 remaining, estimate finish 2024-09-16 22:16:44]
28, 
[40:37 remaining, estimate finish 2024-09-16 22:17:02]
29, 
[36:47 remaining, estimate finish 2024-09-16 22:16:30]
30, 
[33:04 remaining, estimate finish 2024-09-16 22:16:17]
31, 
[29:16 remaining, estimate finish 2024-09-16 22:15:43]
32, 
[25:32 remaining, estimate finish 2024-09-16 22:15:18]
33, 
[21:50 remaining, estimate finish 2024-09-16 22:15:02]
34, 
[18:07 remaining, estimate finish 2024-09-16 22:14:23]
35, 
[14:26 remaining, estimate finish 2024-09-16 22:13:51]
36, 
[10:46 remaining, estimate finish 2024-09-16 22:13:08]
37,  [7:08 remaining] 38,  [3:33 remaining] 
39.

Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(K_ck.csr, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Shwebo District (CSR)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
</section>
</section>
<section id="using-l-function-estimation" class="level3">
<h3 class="anchored" data-anchor-id="using-l-function-estimation">6.2 Using L-Function Estimation</h3>
<p>In this section, I will be computing L-function via <a href="#0">Lest()</a> of <strong>spatstat</strong> package which is normalises the K-function to a linear scale for easier interpretation.</p>
<section id="yinmarbin-district-1" class="level4">
<h4 class="anchored" data-anchor-id="yinmarbin-district-1"><strong>6.2.1 Yinmarbin District</strong></h4>
<p><strong>1) Computing L-function Estimation</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>L_ck <span class="ot">=</span> <span class="fu">Lest</span>(yinmarbin_ppp_owin, <span class="at">correction =</span> <span class="st">"Ripley"</span>)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_ck, . <span class="sc">-</span>r <span class="sc">~</span> r, <span class="at">ylab=</span> <span class="st">"L(d)-r"</span>, <span class="at">xlab =</span> <span class="st">"d(m)"</span>,</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Yinmarbin District (L-Function)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<p><strong>2) Performing Complete Spatial Randomness Test</strong></p>
<p>To confirm the observed spatial patterns above, a hypothesis test will be conducted. The hypothesis and test are as follows:</p>
<ul>
<li><strong>Ho</strong> = The distribution of conflict events in Myanmar are randomly distributed.</li>
<li><strong>H1</strong>= The distribution of conflict events in Myanmar are not randomly distributed.</li>
<li>The null hypothesis will be rejected if <strong>p-value is smaller</strong> than <strong>alpha value of 0.001</strong>.</li>
</ul>
<p>I will also perform monta carlo simulation test using <strong><code>envelope()</code></strong> of the&nbsp;<strong>spatstat</strong>&nbsp;package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Monte Carlo test with L-function</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>L_ck.csr <span class="ot">&lt;-</span> <span class="fu">envelope</span>(yinmarbin_ppp_owin, Lest, </span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nsim =</span> <span class="dv">39</span>, <span class="at">rank =</span> <span class="dv">1</span>, <span class="at">glocal=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 39 simulations of CSR  ...
1, 2, 
[26:56 remaining, estimate finish 2024-09-16 22:43:13]
3, 
[25:21 remaining, estimate finish 2024-09-16 22:42:18]
4, 
[24:56 remaining, estimate finish 2024-09-16 22:42:38]
5, 
[24:28 remaining, estimate finish 2024-09-16 22:42:53]
6, 
[24:22 remaining, estimate finish 2024-09-16 22:43:36]
7, 
[24:41 remaining, estimate finish 2024-09-16 22:44:51]
8, 
[23:30 remaining, estimate finish 2024-09-16 22:44:21]
9, 
[22:50 remaining, estimate finish 2024-09-16 22:44:29]
10, 
[22:19 remaining, estimate finish 2024-09-16 22:44:48]
11, 
[21:28 remaining, estimate finish 2024-09-16 22:44:41]
12, 
[21:13 remaining, estimate finish 2024-09-16 22:45:25]
13, 
[20:43 remaining, estimate finish 2024-09-16 22:45:49]
14, 
[19:47 remaining, estimate finish 2024-09-16 22:45:37]
15, 
[18:48 remaining, estimate finish 2024-09-16 22:45:18]
16, 
[17:58 remaining, estimate finish 2024-09-16 22:45:15]
17, 
[17:08 remaining, estimate finish 2024-09-16 22:45:08]
18, 
[16:26 remaining, estimate finish 2024-09-16 22:45:17]
19, 
[15:36 remaining, estimate finish 2024-09-16 22:45:12]
20, 
[14:47 remaining, estimate finish 2024-09-16 22:45:08]
21, 
[13:56 remaining, estimate finish 2024-09-16 22:44:58]
22, 
[13:07 remaining, estimate finish 2024-09-16 22:44:53]
23, 
[12:19 remaining, estimate finish 2024-09-16 22:44:48]
24, 
[11:30 remaining, estimate finish 2024-09-16 22:44:40]
25, 
[10:40 remaining, estimate finish 2024-09-16 22:44:30]
26,  [9:56 remaining] 27,  [9:12 remaining] 28,  [8:30 remaining] 29,  [7:44 remaining] 30,  [6:56 remaining] 31,  [6:10 remaining] 32,  [5:23 remaining] 33,  [4:36 remaining] 34,  [3:49 remaining] 35,  [3:03 remaining] 36,  [2:17 remaining] 37,  [1:31 remaining] 38,  [45 sec remaining] 
39.

Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_ck.csr, . <span class="sc">-</span> r <span class="sc">~</span> r, <span class="at">xlab=</span><span class="st">"d"</span>, <span class="at">ylab=</span><span class="st">"L(d)-r"</span>,</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Yinmarbin District (CSR)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
</section>
<section id="shwebo-district-1" class="level4">
<h4 class="anchored" data-anchor-id="shwebo-district-1"><strong>6.2.2 Shwebo District</strong></h4>
<p><strong>1) Computing L-function Estimation</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>L_ck <span class="ot">=</span> <span class="fu">Lest</span>(shwebo_ppp_owin, <span class="at">correction =</span> <span class="st">"Ripley"</span>)</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_ck, . <span class="sc">-</span>r <span class="sc">~</span> r, <span class="at">ylab=</span> <span class="st">"L(d)-r"</span>, <span class="at">xlab =</span> <span class="st">"d(m)"</span>,</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Shwebo District (L-Function)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<p><strong>2) Performing Complete Spatial Randomness Test</strong></p>
<p>To confirm the observed spatial patterns above, a hypothesis test will be conducted. The hypothesis and test are as follows:</p>
<ul>
<li><strong>Ho</strong> = The distribution of conflict events in Myanmar are randomly distributed.</li>
<li><strong>H1</strong>= The distribution of conflict events in Myanmar are not randomly distributed.</li>
<li>The null hypothesis will be rejected if <strong>p-value is smaller</strong> than <strong>alpha value of 0.001</strong>.</li>
</ul>
<p>I will also perform monta carlo simulation test using <strong><code>envelope()</code></strong> of the&nbsp;<strong>spatstat</strong>&nbsp;package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Monte Carlo test with L-function</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>L_ck.csr <span class="ot">&lt;-</span> <span class="fu">envelope</span>(shwebo_ppp_owin, Lest, </span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nsim =</span> <span class="dv">39</span>, <span class="at">rank =</span> <span class="dv">1</span>, <span class="at">glocal=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 39 simulations of CSR  ...
1, 2, 
[1:48:44 remaining, estimate finish 2024-09-17 00:47:43]
3, 
[1:45:47 remaining, estimate finish 2024-09-17 00:47:42]
4, 
[1:44:19 remaining, estimate finish 2024-09-17 00:49:18]
5, 
[1:42:10 remaining, estimate finish 2024-09-17 00:50:13]
6, 
[1:39:51 remaining, estimate finish 2024-09-17 00:51:02]
7, 
[1:36:04 remaining, estimate finish 2024-09-17 00:50:07]
8, 
[1:32:40 remaining, estimate finish 2024-09-17 00:49:39]
9, 
[1:29:28 remaining, estimate finish 2024-09-17 00:49:23]
10, 
[1:26:25 remaining, estimate finish 2024-09-17 00:49:16]
11, 
[1:23:13 remaining, estimate finish 2024-09-17 00:48:59]
12, 
[1:19:49 remaining, estimate finish 2024-09-17 00:48:22]
13, 
[1:16:41 remaining, estimate finish 2024-09-17 00:48:06]
14, 
[1:13:34 remaining, estimate finish 2024-09-17 00:47:51]
15, 
[1:10:30 remaining, estimate finish 2024-09-17 00:47:40]
16, 
[1:07:38 remaining, estimate finish 2024-09-17 00:47:47]
17, 
[1:04:40 remaining, estimate finish 2024-09-17 00:47:44]
18, 
[1:01:53 remaining, estimate finish 2024-09-17 00:48:02]
19, 
[59:01 remaining, estimate finish 2024-09-17 00:48:11]
20, 
[56:06 remaining, estimate finish 2024-09-17 00:48:15]
21, 
[53:00 remaining, estimate finish 2024-09-17 00:47:57]
22, 
[50:06 remaining, estimate finish 2024-09-17 00:48:02]
23, 
[47:11 remaining, estimate finish 2024-09-17 00:48:07]
24, 
[44:20 remaining, estimate finish 2024-09-17 00:48:22]
25, 
[41:26 remaining, estimate finish 2024-09-17 00:48:30]
26, 
[38:32 remaining, estimate finish 2024-09-17 00:48:42]
27, 
[35:31 remaining, estimate finish 2024-09-17 00:48:30]
28, 
[32:34 remaining, estimate finish 2024-09-17 00:48:31]
29, 
[29:34 remaining, estimate finish 2024-09-17 00:48:24]
30, 
[26:37 remaining, estimate finish 2024-09-17 00:48:25]
31, 
[23:39 remaining, estimate finish 2024-09-17 00:48:21]
32, 
[20:39 remaining, estimate finish 2024-09-17 00:48:10]
33, 
[17:43 remaining, estimate finish 2024-09-17 00:48:14]
34, 
[14:44 remaining, estimate finish 2024-09-17 00:48:02]
35, 
[11:47 remaining, estimate finish 2024-09-17 00:47:56]
36,  [8:51 remaining] 37,  [5:55 remaining] 38,  [2:58 remaining] 
39.

Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_ck.csr, . <span class="sc">-</span> r <span class="sc">~</span> r, <span class="at">xlab=</span><span class="st">"d"</span>, <span class="at">ylab=</span><span class="st">"L(d)-r"</span>,</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Shwebo District (CSR)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Observations">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
</section>
</section>
</section>
<section id="spatio-tempmoral-kde" class="level2">
<h2 class="anchored" data-anchor-id="spatio-tempmoral-kde">7. Spatio-Tempmoral KDE</h2>
<p>We focus on the continuous time</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<p>Crawley, M. J. (2007). The R Book. Wiley.</p>
<p>The Stata Journal. (2003). Adaptive kernel density estimation. Sage Journals. <a href="https://journals.sagepub.com/doi/pdf/10.1177/1536867X0300300204https://journals.sagepub.com/doi/pdf/10.1177/1536867X0300300204">https://journals.sagepub.com/doi/pdf/10.1177/1536867X0300300204</a></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>